!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.dgl=e()}}(function(){return function e(t,r,n){function i(o,u){if(!r[o]){if(!t[o]){var s="function"==typeof require&&require;if(!u&&s)return s(o,!0);if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[o]={exports:{}};t[o][0].call(c.exports,function(e){var r=t[o][1][e];return i(r?r:e)},c,c.exports,e,t,r,n)}return r[o].exports}for(var a="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,r){function n(){h&&c&&(h=!1,c.length?f=c.concat(f):d=-1,f.length&&i())}function i(){if(!h){var e=u(n);h=!0;for(var t=f.length;t;){for(c=f,f=[];++d<t;)c&&c[d].run();d=-1,t=f.length}c=null,h=!1,s(e)}}function a(e,t){this.fun=e,this.array=t}function o(){}var u,s,l=t.exports={};!function(){try{u=setTimeout}catch(e){u=function(){throw new Error("setTimeout is not defined")}}try{s=clearTimeout}catch(e){s=function(){throw new Error("clearTimeout is not defined")}}}();var c,f=[],h=!1,d=-1;l.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];f.push(new a(e,t)),1!==f.length||h||u(i,0)},a.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=o,l.addListener=o,l.once=o,l.off=o,l.removeListener=o,l.removeAllListeners=o,l.emit=o,l.binding=function(e){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(e){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},{}],2:[function(e,t,r){r.glMatrix=e("./gl-matrix/common.js"),r.mat2=e("./gl-matrix/mat2.js"),r.mat2d=e("./gl-matrix/mat2d.js"),r.mat3=e("./gl-matrix/mat3.js"),r.mat4=e("./gl-matrix/mat4.js"),r.quat=e("./gl-matrix/quat.js"),r.vec2=e("./gl-matrix/vec2.js"),r.vec3=e("./gl-matrix/vec3.js"),r.vec4=e("./gl-matrix/vec4.js")},{"./gl-matrix/common.js":3,"./gl-matrix/mat2.js":4,"./gl-matrix/mat2d.js":5,"./gl-matrix/mat3.js":6,"./gl-matrix/mat4.js":7,"./gl-matrix/quat.js":8,"./gl-matrix/vec2.js":9,"./gl-matrix/vec3.js":10,"./gl-matrix/vec4.js":11}],3:[function(e,t,r){var n={};n.EPSILON=1e-6,n.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,n.RANDOM=Math.random,n.setMatrixArrayType=function(e){GLMAT_ARRAY_TYPE=e};var i=Math.PI/180;n.toRadian=function(e){return e*i},t.exports=n},{}],4:[function(e,t,r){var n=e("./common.js"),i={};i.create=function(){var e=new n.ARRAY_TYPE(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},i.clone=function(e){var t=new n.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},i.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},i.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},i.transpose=function(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},i.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*a-i*n;return o?(o=1/o,e[0]=a*o,e[1]=-n*o,e[2]=-i*o,e[3]=r*o,e):null},i.adjoint=function(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e},i.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},i.multiply=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=r[0],s=r[1],l=r[2],c=r[3];return e[0]=n*u+a*s,e[1]=i*u+o*s,e[2]=n*l+a*c,e[3]=i*l+o*c,e},i.mul=i.multiply,i.rotate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=Math.sin(r),s=Math.cos(r);return e[0]=n*s+a*u,e[1]=i*s+o*u,e[2]=n*-u+a*s,e[3]=i*-u+o*s,e},i.scale=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=r[0],s=r[1];return e[0]=n*u,e[1]=i*u,e[2]=a*s,e[3]=o*s,e},i.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e},i.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},i.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},i.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))},i.LDU=function(e,t,r,n){return e[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-e[2]*r[1],[e,t,r]},t.exports=i},{"./common.js":3}],5:[function(e,t,r){var n=e("./common.js"),i={};i.create=function(){var e=new n.ARRAY_TYPE(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},i.clone=function(e){var t=new n.ARRAY_TYPE(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},i.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},i.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},i.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],u=t[5],s=r*a-n*i;return s?(s=1/s,e[0]=a*s,e[1]=-n*s,e[2]=-i*s,e[3]=r*s,e[4]=(i*u-a*o)*s,e[5]=(n*o-r*u)*s,e):null},i.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},i.multiply=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=t[4],s=t[5],l=r[0],c=r[1],f=r[2],h=r[3],d=r[4],p=r[5];return e[0]=n*l+a*c,e[1]=i*l+o*c,e[2]=n*f+a*h,e[3]=i*f+o*h,e[4]=n*d+a*p+u,e[5]=i*d+o*p+s,e},i.mul=i.multiply,i.rotate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=t[4],s=t[5],l=Math.sin(r),c=Math.cos(r);return e[0]=n*c+a*l,e[1]=i*c+o*l,e[2]=n*-l+a*c,e[3]=i*-l+o*c,e[4]=u,e[5]=s,e},i.scale=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=t[4],s=t[5],l=r[0],c=r[1];return e[0]=n*l,e[1]=i*l,e[2]=a*c,e[3]=o*c,e[4]=u,e[5]=s,e},i.translate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=t[4],s=t[5],l=r[0],c=r[1];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=n*l+a*c+u,e[5]=i*l+o*c+s,e},i.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e[4]=0,e[5]=0,e},i.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},i.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},i.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},i.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},t.exports=i},{"./common.js":3}],6:[function(e,t,r){var n=e("./common.js"),i={};i.create=function(){var e=new n.ARRAY_TYPE(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},i.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},i.clone=function(e){var t=new n.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},i.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},i.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},i.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},i.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],u=t[5],s=t[6],l=t[7],c=t[8],f=c*o-u*l,h=-c*a+u*s,d=l*a-o*s,p=r*f+n*h+i*d;return p?(p=1/p,e[0]=f*p,e[1]=(-c*n+i*l)*p,e[2]=(u*n-i*o)*p,e[3]=h*p,e[4]=(c*r-i*s)*p,e[5]=(-u*r+i*a)*p,e[6]=d*p,e[7]=(-l*r+n*s)*p,e[8]=(o*r-n*a)*p,e):null},i.adjoint=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],u=t[5],s=t[6],l=t[7],c=t[8];return e[0]=o*c-u*l,e[1]=i*l-n*c,e[2]=n*u-i*o,e[3]=u*s-a*c,e[4]=r*c-i*s,e[5]=i*a-r*u,e[6]=a*l-o*s,e[7]=n*s-r*l,e[8]=r*o-n*a,e},i.determinant=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],u=e[6],s=e[7],l=e[8];return t*(l*a-o*s)+r*(-l*i+o*u)+n*(s*i-a*u)},i.multiply=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=t[4],s=t[5],l=t[6],c=t[7],f=t[8],h=r[0],d=r[1],p=r[2],v=r[3],m=r[4],y=r[5],b=r[6],g=r[7],_=r[8];return e[0]=h*n+d*o+p*l,e[1]=h*i+d*u+p*c,e[2]=h*a+d*s+p*f,e[3]=v*n+m*o+y*l,e[4]=v*i+m*u+y*c,e[5]=v*a+m*s+y*f,e[6]=b*n+g*o+_*l,e[7]=b*i+g*u+_*c,e[8]=b*a+g*s+_*f,e},i.mul=i.multiply,i.translate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=t[4],s=t[5],l=t[6],c=t[7],f=t[8],h=r[0],d=r[1];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=u,e[5]=s,e[6]=h*n+d*o+l,e[7]=h*i+d*u+c,e[8]=h*a+d*s+f,e},i.rotate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=t[4],s=t[5],l=t[6],c=t[7],f=t[8],h=Math.sin(r),d=Math.cos(r);return e[0]=d*n+h*o,e[1]=d*i+h*u,e[2]=d*a+h*s,e[3]=d*o-h*n,e[4]=d*u-h*i,e[5]=d*s-h*a,e[6]=l,e[7]=c,e[8]=f,e},i.scale=function(e,t,r){var n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},i.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},i.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},i.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},i.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},i.fromQuat=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,u=n+n,s=i+i,l=r*o,c=n*o,f=n*u,h=i*o,d=i*u,p=i*s,v=a*o,m=a*u,y=a*s;return e[0]=1-f-p,e[3]=c-y,e[6]=h+m,e[1]=c+y,e[4]=1-l-p,e[7]=d-v,e[2]=h-m,e[5]=d+v,e[8]=1-l-f,e},i.normalFromMat4=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],u=t[5],s=t[6],l=t[7],c=t[8],f=t[9],h=t[10],d=t[11],p=t[12],v=t[13],m=t[14],y=t[15],b=r*u-n*o,g=r*s-i*o,_=r*l-a*o,P=n*s-i*u,M=n*l-a*u,E=i*l-a*s,x=c*v-f*p,O=c*m-h*p,w=c*y-d*p,T=f*m-h*v,j=f*y-d*v,R=h*y-d*m,A=b*R-g*j+_*T+P*w-M*O+E*x;return A?(A=1/A,e[0]=(u*R-s*j+l*T)*A,e[1]=(s*w-o*R-l*O)*A,e[2]=(o*j-u*w+l*x)*A,e[3]=(i*j-n*R-a*T)*A,e[4]=(r*R-i*w+a*O)*A,e[5]=(n*w-r*j-a*x)*A,e[6]=(v*E-m*M+y*P)*A,e[7]=(m*_-p*E-y*g)*A,e[8]=(p*M-v*_+y*b)*A,e):null},i.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},i.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},t.exports=i},{"./common.js":3}],7:[function(e,t,r){var n=e("./common.js"),i={};i.create=function(){var e=new n.ARRAY_TYPE(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},i.clone=function(e){var t=new n.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},i.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},i.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],a=t[6],o=t[7],u=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=a,e[11]=t[14],e[12]=i,e[13]=o,e[14]=u}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},i.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],u=t[5],s=t[6],l=t[7],c=t[8],f=t[9],h=t[10],d=t[11],p=t[12],v=t[13],m=t[14],y=t[15],b=r*u-n*o,g=r*s-i*o,_=r*l-a*o,P=n*s-i*u,M=n*l-a*u,E=i*l-a*s,x=c*v-f*p,O=c*m-h*p,w=c*y-d*p,T=f*m-h*v,j=f*y-d*v,R=h*y-d*m,A=b*R-g*j+_*T+P*w-M*O+E*x;return A?(A=1/A,e[0]=(u*R-s*j+l*T)*A,e[1]=(i*j-n*R-a*T)*A,e[2]=(v*E-m*M+y*P)*A,e[3]=(h*M-f*E-d*P)*A,e[4]=(s*w-o*R-l*O)*A,e[5]=(r*R-i*w+a*O)*A,e[6]=(m*_-p*E-y*g)*A,e[7]=(c*E-h*_+d*g)*A,e[8]=(o*j-u*w+l*x)*A,e[9]=(n*w-r*j-a*x)*A,e[10]=(p*M-v*_+y*b)*A,e[11]=(f*_-c*M-d*b)*A,e[12]=(u*O-o*T-s*x)*A,e[13]=(r*T-n*O+i*x)*A,e[14]=(v*g-p*P-m*b)*A,e[15]=(c*P-f*g+h*b)*A,e):null},i.adjoint=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],u=t[5],s=t[6],l=t[7],c=t[8],f=t[9],h=t[10],d=t[11],p=t[12],v=t[13],m=t[14],y=t[15];return e[0]=u*(h*y-d*m)-f*(s*y-l*m)+v*(s*d-l*h),e[1]=-(n*(h*y-d*m)-f*(i*y-a*m)+v*(i*d-a*h)),e[2]=n*(s*y-l*m)-u*(i*y-a*m)+v*(i*l-a*s),e[3]=-(n*(s*d-l*h)-u*(i*d-a*h)+f*(i*l-a*s)),e[4]=-(o*(h*y-d*m)-c*(s*y-l*m)+p*(s*d-l*h)),e[5]=r*(h*y-d*m)-c*(i*y-a*m)+p*(i*d-a*h),e[6]=-(r*(s*y-l*m)-o*(i*y-a*m)+p*(i*l-a*s)),e[7]=r*(s*d-l*h)-o*(i*d-a*h)+c*(i*l-a*s),e[8]=o*(f*y-d*v)-c*(u*y-l*v)+p*(u*d-l*f),e[9]=-(r*(f*y-d*v)-c*(n*y-a*v)+p*(n*d-a*f)),e[10]=r*(u*y-l*v)-o*(n*y-a*v)+p*(n*l-a*u),e[11]=-(r*(u*d-l*f)-o*(n*d-a*f)+c*(n*l-a*u)),e[12]=-(o*(f*m-h*v)-c*(u*m-s*v)+p*(u*h-s*f)),e[13]=r*(f*m-h*v)-c*(n*m-i*v)+p*(n*h-i*f),e[14]=-(r*(u*m-s*v)-o*(n*m-i*v)+p*(n*s-i*u)),e[15]=r*(u*h-s*f)-o*(n*h-i*f)+c*(n*s-i*u),e},i.determinant=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],u=e[6],s=e[7],l=e[8],c=e[9],f=e[10],h=e[11],d=e[12],p=e[13],v=e[14],m=e[15],y=t*o-r*a,b=t*u-n*a,g=t*s-i*a,_=r*u-n*o,P=r*s-i*o,M=n*s-i*u,E=l*p-c*d,x=l*v-f*d,O=l*m-h*d,w=c*v-f*p,T=c*m-h*p,j=f*m-h*v;return y*j-b*T+g*w+_*O-P*x+M*E},i.multiply=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=t[4],s=t[5],l=t[6],c=t[7],f=t[8],h=t[9],d=t[10],p=t[11],v=t[12],m=t[13],y=t[14],b=t[15],g=r[0],_=r[1],P=r[2],M=r[3];return e[0]=g*n+_*u+P*f+M*v,e[1]=g*i+_*s+P*h+M*m,e[2]=g*a+_*l+P*d+M*y,e[3]=g*o+_*c+P*p+M*b,g=r[4],_=r[5],P=r[6],M=r[7],e[4]=g*n+_*u+P*f+M*v,e[5]=g*i+_*s+P*h+M*m,e[6]=g*a+_*l+P*d+M*y,e[7]=g*o+_*c+P*p+M*b,g=r[8],_=r[9],P=r[10],M=r[11],e[8]=g*n+_*u+P*f+M*v,e[9]=g*i+_*s+P*h+M*m,e[10]=g*a+_*l+P*d+M*y,e[11]=g*o+_*c+P*p+M*b,g=r[12],_=r[13],P=r[14],M=r[15],e[12]=g*n+_*u+P*f+M*v,e[13]=g*i+_*s+P*h+M*m,e[14]=g*a+_*l+P*d+M*y,e[15]=g*o+_*c+P*p+M*b,e},i.mul=i.multiply,i.translate=function(e,t,r){var n,i,a,o,u,s,l,c,f,h,d,p,v=r[0],m=r[1],y=r[2];return t===e?(e[12]=t[0]*v+t[4]*m+t[8]*y+t[12],e[13]=t[1]*v+t[5]*m+t[9]*y+t[13],e[14]=t[2]*v+t[6]*m+t[10]*y+t[14],e[15]=t[3]*v+t[7]*m+t[11]*y+t[15]):(n=t[0],i=t[1],a=t[2],o=t[3],u=t[4],s=t[5],l=t[6],c=t[7],f=t[8],h=t[9],d=t[10],p=t[11],e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=u,e[5]=s,e[6]=l,e[7]=c,e[8]=f,e[9]=h,e[10]=d,e[11]=p,e[12]=n*v+u*m+f*y+t[12],e[13]=i*v+s*m+h*y+t[13],e[14]=a*v+l*m+d*y+t[14],e[15]=o*v+c*m+p*y+t[15]),e},i.scale=function(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},i.rotate=function(e,t,r,i){var a,o,u,s,l,c,f,h,d,p,v,m,y,b,g,_,P,M,E,x,O,w,T,j,R=i[0],A=i[1],C=i[2],S=Math.sqrt(R*R+A*A+C*C);return Math.abs(S)<n.EPSILON?null:(S=1/S,R*=S,A*=S,C*=S,a=Math.sin(r),o=Math.cos(r),u=1-o,s=t[0],l=t[1],c=t[2],f=t[3],h=t[4],d=t[5],p=t[6],v=t[7],m=t[8],y=t[9],b=t[10],g=t[11],_=R*R*u+o,P=A*R*u+C*a,M=C*R*u-A*a,E=R*A*u-C*a,x=A*A*u+o,O=C*A*u+R*a,w=R*C*u+A*a,T=A*C*u-R*a,j=C*C*u+o,e[0]=s*_+h*P+m*M,e[1]=l*_+d*P+y*M,e[2]=c*_+p*P+b*M,e[3]=f*_+v*P+g*M,e[4]=s*E+h*x+m*O,e[5]=l*E+d*x+y*O,e[6]=c*E+p*x+b*O,e[7]=f*E+v*x+g*O,e[8]=s*w+h*T+m*j,e[9]=l*w+d*T+y*j,e[10]=c*w+p*T+b*j,e[11]=f*w+v*T+g*j,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},i.rotateX=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],o=t[5],u=t[6],s=t[7],l=t[8],c=t[9],f=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+l*n,e[5]=o*i+c*n,e[6]=u*i+f*n,e[7]=s*i+h*n,e[8]=l*i-a*n,e[9]=c*i-o*n,e[10]=f*i-u*n,e[11]=h*i-s*n,e},i.rotateY=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],u=t[2],s=t[3],l=t[8],c=t[9],f=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-l*n,e[1]=o*i-c*n,e[2]=u*i-f*n,e[3]=s*i-h*n,e[8]=a*n+l*i,e[9]=o*n+c*i,e[10]=u*n+f*i,e[11]=s*n+h*i,e},i.rotateZ=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],u=t[2],s=t[3],l=t[4],c=t[5],f=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+l*n,e[1]=o*i+c*n,e[2]=u*i+f*n,e[3]=s*i+h*n,e[4]=l*i-a*n,e[5]=c*i-o*n,e[6]=f*i-u*n,e[7]=h*i-s*n,e},i.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},i.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},i.fromRotation=function(e,t,r){var i,a,o,u=r[0],s=r[1],l=r[2],c=Math.sqrt(u*u+s*s+l*l);return Math.abs(c)<n.EPSILON?null:(c=1/c,u*=c,s*=c,l*=c,i=Math.sin(t),a=Math.cos(t),o=1-a,e[0]=u*u*o+a,e[1]=s*u*o+l*i,e[2]=l*u*o-s*i,e[3]=0,e[4]=u*s*o-l*i,e[5]=s*s*o+a,e[6]=l*s*o+u*i,e[7]=0,e[8]=u*l*o+s*i,e[9]=s*l*o-u*i,e[10]=l*l*o+a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},i.fromXRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},i.fromYRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},i.fromZRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},i.fromRotationTranslation=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=n+n,s=i+i,l=a+a,c=n*u,f=n*s,h=n*l,d=i*s,p=i*l,v=a*l,m=o*u,y=o*s,b=o*l;return e[0]=1-(d+v),e[1]=f+b,e[2]=h-y,e[3]=0,e[4]=f-b,e[5]=1-(c+v),e[6]=p+m,e[7]=0,e[8]=h+y,e[9]=p-m,e[10]=1-(c+d),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},i.fromRotationTranslationScale=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],u=t[3],s=i+i,l=a+a,c=o+o,f=i*s,h=i*l,d=i*c,p=a*l,v=a*c,m=o*c,y=u*s,b=u*l,g=u*c,_=n[0],P=n[1],M=n[2];return e[0]=(1-(p+m))*_,e[1]=(h+g)*_,e[2]=(d-b)*_,e[3]=0,e[4]=(h-g)*P,e[5]=(1-(f+m))*P,e[6]=(v+y)*P,e[7]=0,e[8]=(d+b)*M,e[9]=(v-y)*M,e[10]=(1-(f+p))*M,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},i.fromRotationTranslationScaleOrigin=function(e,t,r,n,i){var a=t[0],o=t[1],u=t[2],s=t[3],l=a+a,c=o+o,f=u+u,h=a*l,d=a*c,p=a*f,v=o*c,m=o*f,y=u*f,b=s*l,g=s*c,_=s*f,P=n[0],M=n[1],E=n[2],x=i[0],O=i[1],w=i[2];return e[0]=(1-(v+y))*P,e[1]=(d+_)*P,e[2]=(p-g)*P,e[3]=0,e[4]=(d-_)*M,e[5]=(1-(h+y))*M,e[6]=(m+b)*M,e[7]=0,e[8]=(p+g)*E,e[9]=(m-b)*E,e[10]=(1-(h+v))*E,e[11]=0,e[12]=r[0]+x-(e[0]*x+e[4]*O+e[8]*w),e[13]=r[1]+O-(e[1]*x+e[5]*O+e[9]*w),e[14]=r[2]+w-(e[2]*x+e[6]*O+e[10]*w),e[15]=1,e},i.fromQuat=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,u=n+n,s=i+i,l=r*o,c=n*o,f=n*u,h=i*o,d=i*u,p=i*s,v=a*o,m=a*u,y=a*s;return e[0]=1-f-p,e[1]=c+y,e[2]=h-m,e[3]=0,e[4]=c-y,e[5]=1-l-p,e[6]=d+v,e[7]=0,e[8]=h+m,e[9]=d-v,e[10]=1-l-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},i.frustum=function(e,t,r,n,i,a,o){var u=1/(r-t),s=1/(i-n),l=1/(a-o);return e[0]=2*a*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*s,e[6]=0,e[7]=0,e[8]=(r+t)*u,e[9]=(i+n)*s,e[10]=(o+a)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*l,e[15]=0,e},i.perspective=function(e,t,r,n,i){var a=1/Math.tan(t/2),o=1/(n-i);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+n)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*n*o,e[15]=0,e},i.perspectiveFromFieldOfView=function(e,t,r,n){var i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),u=Math.tan(t.rightDegrees*Math.PI/180),s=2/(o+u),l=2/(i+a);return e[0]=s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-((o-u)*s*.5),e[9]=(i-a)*l*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e},i.ortho=function(e,t,r,n,i,a,o){var u=1/(t-r),s=1/(n-i),l=1/(a-o);return e[0]=-2*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+r)*u,e[13]=(i+n)*s,e[14]=(o+a)*l,e[15]=1,e},i.lookAt=function(e,t,r,a){var o,u,s,l,c,f,h,d,p,v,m=t[0],y=t[1],b=t[2],g=a[0],_=a[1],P=a[2],M=r[0],E=r[1],x=r[2];return Math.abs(m-M)<n.EPSILON&&Math.abs(y-E)<n.EPSILON&&Math.abs(b-x)<n.EPSILON?i.identity(e):(h=m-M,d=y-E,p=b-x,v=1/Math.sqrt(h*h+d*d+p*p),h*=v,d*=v,p*=v,o=_*p-P*d,u=P*h-g*p,s=g*d-_*h,v=Math.sqrt(o*o+u*u+s*s),v?(v=1/v,o*=v,u*=v,s*=v):(o=0,u=0,s=0),l=d*s-p*u,c=p*o-h*s,f=h*u-d*o,v=Math.sqrt(l*l+c*c+f*f),v?(v=1/v,l*=v,c*=v,f*=v):(l=0,c=0,f=0),e[0]=o,e[1]=l,e[2]=h,e[3]=0,e[4]=u,e[5]=c,e[6]=d,e[7]=0,e[8]=s,e[9]=f,e[10]=p,e[11]=0,e[12]=-(o*m+u*y+s*b),e[13]=-(l*m+c*y+f*b),e[14]=-(h*m+d*y+p*b),e[15]=1,e)},i.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},i.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},t.exports=i},{"./common.js":3}],8:[function(e,t,r){var n=e("./common.js"),i=e("./mat3.js"),a=e("./vec3.js"),o=e("./vec4.js"),u={};u.create=function(){var e=new n.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},u.rotationTo=function(){var e=a.create(),t=a.fromValues(1,0,0),r=a.fromValues(0,1,0);return function(n,i,o){var s=a.dot(i,o);return s<-.999999?(a.cross(e,t,i),a.length(e)<1e-6&&a.cross(e,r,i),a.normalize(e,e),u.setAxisAngle(n,e,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(a.cross(e,i,o),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+s,u.normalize(n,n))}}(),u.setAxes=function(){var e=i.create();return function(t,r,n,i){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],u.normalize(t,u.fromMat3(t,e))}}(),u.clone=o.clone,u.fromValues=o.fromValues,u.copy=o.copy,u.set=o.set,u.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},u.setAxisAngle=function(e,t,r){r=.5*r;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e},u.add=o.add,u.multiply=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=r[0],s=r[1],l=r[2],c=r[3];return e[0]=n*c+o*u+i*l-a*s,e[1]=i*c+o*s+a*u-n*l,e[2]=a*c+o*l+n*s-i*u,e[3]=o*c-n*u-i*s-a*l,e},u.mul=u.multiply,u.scale=o.scale,u.rotateX=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],u=Math.sin(r),s=Math.cos(r);return e[0]=n*s+o*u,e[1]=i*s+a*u,e[2]=a*s-i*u,e[3]=o*s-n*u,e},u.rotateY=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],u=Math.sin(r),s=Math.cos(r);return e[0]=n*s-a*u,e[1]=i*s+o*u,e[2]=a*s+n*u,e[3]=o*s-i*u,e},u.rotateZ=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],u=Math.sin(r),s=Math.cos(r);return e[0]=n*s+i*u,e[1]=i*s-n*u,e[2]=a*s+o*u,e[3]=o*s-a*u,e},u.calculateW=function(e,t){var r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),e},u.dot=o.dot,u.lerp=o.lerp,u.slerp=function(e,t,r,n){var i,a,o,u,s,l=t[0],c=t[1],f=t[2],h=t[3],d=r[0],p=r[1],v=r[2],m=r[3];return a=l*d+c*p+f*v+h*m,a<0&&(a=-a,d=-d,p=-p,v=-v,m=-m),1-a>1e-6?(i=Math.acos(a),o=Math.sin(i),u=Math.sin((1-n)*i)/o,s=Math.sin(n*i)/o):(u=1-n,s=n),e[0]=u*l+s*d,e[1]=u*c+s*p,e[2]=u*f+s*v,e[3]=u*h+s*m,e},u.sqlerp=function(){var e=u.create(),t=u.create();return function(r,n,i,a,o,s){return u.slerp(e,n,o,s),u.slerp(t,i,a,s),u.slerp(r,e,t,2*s*(1-s)),r}}(),u.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a,u=o?1/o:0;return e[0]=-r*u,e[1]=-n*u,e[2]=-i*u,e[3]=a*u,e},u.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},u.length=o.length,u.len=u.length,u.squaredLength=o.squaredLength,u.sqrLen=u.squaredLength,u.normalize=o.normalize,u.fromMat3=function(e,t){var r,n=t[0]+t[4]+t[8];if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;r=Math.sqrt(t[3*i+i]-t[3*a+a]-t[3*o+o]+1),e[i]=.5*r,r=.5/r,e[3]=(t[3*a+o]-t[3*o+a])*r,e[a]=(t[3*a+i]+t[3*i+a])*r,e[o]=(t[3*o+i]+t[3*i+o])*r}return e},u.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.exports=u},{"./common.js":3,"./mat3.js":6,"./vec3.js":10,"./vec4.js":11}],9:[function(e,t,r){var n=e("./common.js"),i={};i.create=function(){var e=new n.ARRAY_TYPE(2);return e[0]=0,e[1]=0,e},i.clone=function(e){var t=new n.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},i.fromValues=function(e,t){var r=new n.ARRAY_TYPE(2);return r[0]=e,r[1]=t,r},i.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},i.set=function(e,t,r){return e[0]=t,e[1]=r,e},i.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e},i.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e},i.sub=i.subtract,i.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e},i.mul=i.multiply,i.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e},i.div=i.divide,i.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e},i.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e},i.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e},i.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e},i.distance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)},i.dist=i.distance,i.squaredDistance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n},i.sqrDist=i.squaredDistance,i.length=function(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)},i.len=i.length,i.squaredLength=function(e){var t=e[0],r=e[1];return t*t+r*r},i.sqrLen=i.squaredLength,i.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},i.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},i.normalize=function(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e},i.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},i.cross=function(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e},i.lerp=function(e,t,r,n){var i=t[0],a=t[1];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e},i.random=function(e,t){t=t||1;var r=2*n.RANDOM()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e},i.transformMat2=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e},i.transformMat2d=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e},i.transformMat3=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e},i.transformMat4=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e},i.forEach=function(){var e=i.create();return function(t,r,n,i,a,o){var u,s;for(r||(r=2),n||(n=0),s=i?Math.min(i*r+n,t.length):t.length,u=n;u<s;u+=r)e[0]=t[u],e[1]=t[u+1],a(e,e,o),t[u]=e[0],t[u+1]=e[1];return t}}(),i.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},t.exports=i},{"./common.js":3}],10:[function(e,t,r){var n=e("./common.js"),i={};i.create=function(){var e=new n.ARRAY_TYPE(3);return e[0]=0,e[1]=0,e[2]=0,e},i.clone=function(e){var t=new n.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},i.fromValues=function(e,t,r){var i=new n.ARRAY_TYPE(3);return i[0]=e,i[1]=t,i[2]=r,i},i.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},i.set=function(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e},i.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},i.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},i.sub=i.subtract,i.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e},i.mul=i.multiply,i.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e},i.div=i.divide,i.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e},i.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e},i.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},i.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e},i.distance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(r*r+n*n+i*i)},i.dist=i.distance,i.squaredDistance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i},i.sqrDist=i.squaredDistance,i.length=function(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)},i.len=i.length,i.squaredLength=function(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n},i.sqrLen=i.squaredLength,i.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},i.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},i.normalize=function(e,t){var r=t[0],n=t[1],i=t[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a),e},i.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},i.cross=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],u=r[1],s=r[2];return e[0]=i*s-a*u,e[1]=a*o-n*s,e[2]=n*u-i*o,e},i.lerp=function(e,t,r,n){var i=t[0],a=t[1],o=t[2];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=o+n*(r[2]-o),e},i.hermite=function(e,t,r,n,i,a){var o=a*a,u=o*(2*a-3)+1,s=o*(a-2)+a,l=o*(a-1),c=o*(3-2*a);return e[0]=t[0]*u+r[0]*s+n[0]*l+i[0]*c,e[1]=t[1]*u+r[1]*s+n[1]*l+i[1]*c,e[2]=t[2]*u+r[2]*s+n[2]*l+i[2]*c,e},i.bezier=function(e,t,r,n,i,a){var o=1-a,u=o*o,s=a*a,l=u*o,c=3*a*u,f=3*s*o,h=s*a;return e[0]=t[0]*l+r[0]*c+n[0]*f+i[0]*h,e[1]=t[1]*l+r[1]*c+n[1]*f+i[1]*h,e[2]=t[2]*l+r[2]*c+n[2]*f+i[2]*h,e},i.random=function(e,t){t=t||1;var r=2*n.RANDOM()*Math.PI,i=2*n.RANDOM()-1,a=Math.sqrt(1-i*i)*t;return e[0]=Math.cos(r)*a,e[1]=Math.sin(r)*a,e[2]=i*t,e},i.transformMat4=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return o=o||1,e[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/o,e[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,e[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,e},i.transformMat3=function(e,t,r){var n=t[0],i=t[1],a=t[2];return e[0]=n*r[0]+i*r[3]+a*r[6],e[1]=n*r[1]+i*r[4]+a*r[7],e[2]=n*r[2]+i*r[5]+a*r[8],e},i.transformQuat=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],u=r[1],s=r[2],l=r[3],c=l*n+u*a-s*i,f=l*i+s*n-o*a,h=l*a+o*i-u*n,d=-o*n-u*i-s*a;return e[0]=c*l+d*-o+f*-s-h*-u,e[1]=f*l+d*-u+h*-o-c*-s,e[2]=h*l+d*-s+c*-u-f*-o,e},i.rotateX=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},i.rotateY=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},i.rotateZ=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},i.forEach=function(){var e=i.create();return function(t,r,n,i,a,o){var u,s;for(r||(r=3),n||(n=0),s=i?Math.min(i*r+n,t.length):t.length,u=n;u<s;u+=r)e[0]=t[u],e[1]=t[u+1],e[2]=t[u+2],a(e,e,o),t[u]=e[0],t[u+1]=e[1],t[u+2]=e[2];return t}}(),i.angle=function(e,t){var r=i.fromValues(e[0],e[1],e[2]),n=i.fromValues(t[0],t[1],t[2]);i.normalize(r,r),i.normalize(n,n);var a=i.dot(r,n);return a>1?0:Math.acos(a)},i.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},t.exports=i},{"./common.js":3}],11:[function(e,t,r){var n=e("./common.js"),i={};i.create=function(){var e=new n.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},i.clone=function(e){var t=new n.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},i.fromValues=function(e,t,r,i){var a=new n.ARRAY_TYPE(4);return a[0]=e,a[1]=t,a[2]=r,a[3]=i,a},i.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},i.set=function(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e},i.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},i.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],
e},i.sub=i.subtract,i.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e},i.mul=i.multiply,i.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e},i.div=i.divide,i.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e},i.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e},i.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},i.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e},i.distance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return Math.sqrt(r*r+n*n+i*i+a*a)},i.dist=i.distance,i.squaredDistance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return r*r+n*n+i*i+a*a},i.sqrDist=i.squaredDistance,i.length=function(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.sqrt(t*t+r*r+n*n+i*i)},i.len=i.length,i.squaredLength=function(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i},i.sqrLen=i.squaredLength,i.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},i.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},i.normalize=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a;return o>0&&(o=1/Math.sqrt(o),e[0]=r*o,e[1]=n*o,e[2]=i*o,e[3]=a*o),e},i.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},i.lerp=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],u=t[3];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=o+n*(r[2]-o),e[3]=u+n*(r[3]-u),e},i.random=function(e,t){return t=t||1,e[0]=n.RANDOM(),e[1]=n.RANDOM(),e[2]=n.RANDOM(),e[3]=n.RANDOM(),i.normalize(e,e),i.scale(e,e,t),e},i.transformMat4=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,e},i.transformQuat=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],u=r[1],s=r[2],l=r[3],c=l*n+u*a-s*i,f=l*i+s*n-o*a,h=l*a+o*i-u*n,d=-o*n-u*i-s*a;return e[0]=c*l+d*-o+f*-s-h*-u,e[1]=f*l+d*-u+h*-o-c*-s,e[2]=h*l+d*-s+c*-u-f*-o,e[3]=t[3],e},i.forEach=function(){var e=i.create();return function(t,r,n,i,a,o){var u,s;for(r||(r=4),n||(n=0),s=i?Math.min(i*r+n,t.length):t.length,u=n;u<s;u+=r)e[0]=t[u],e[1]=t[u+1],e[2]=t[u+2],e[3]=t[u+3],a(e,e,o),t[u]=e[0],t[u+1]=e[1],t[u+2]=e[2],t[u+3]=e[3];return t}}(),i.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.exports=i},{"./common.js":3}],12:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t,r){n(this,e),this._data=t,this.byteLength=t.byteLength,this.type=e.ArrayBuffer,this.drawType=e.StaticDraw,this.options=Object.assign({},e.defaultOptions,r),this._glBuffer=null,this._glContext=null}return i(e,[{key:"bind",value:function(t,r,n){return this._glBuffer||this._prepare(t),this.type===e.ArrayBuffer?(t.bindBuffer(t.ARRAY_BUFFER,this._glBuffer),n=n||this.options,t.vertexAttribPointer(r,n.itemSize,this._toGlParam(t,n.dataType),n.normalized,n.stride,n.offset)):this.type===e.ElementArrayBuffer&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._glBuffer),this}},{key:"remove",value:function(){return this._unprepare(),this}},{key:"subData",value:function(e,t,r){return e.bindBuffer(this._toGlParam(e,this.type),this._glBuffer),e.bufferSubData(this._toGlParam(e,this.type),t*this.itemSize,r),this}},{key:"_prepare",value:function(e){this._glContext=e,this._glBuffer=e.createBuffer(),e.bindBuffer(this._toGlParam(e,this.type),this._glBuffer),e.bufferData(this._toGlParam(e,this.type),this._data,this._toGlParam(e,this.drawType)),this._data=null}},{key:"_unprepare",value:function(){this._glBuffer&&(this._glContext.deleteBuffer(this._glBuffer),this._glBuffer=null,this._glContext=null)}},{key:"_toGlParam",value:function(t,r){return r===e.ArrayBuffer?t.ARRAY_BUFFER:r===e.ElementArrayBuffer?t.ELEMENT_ARRAY_BUFFER:r===e.StaticDraw?t.STATIC_DRAW:r===e.DynamicDraw?t.DYNAMIC_DRAW:r===e.Byte?t.BYTE:r===e.Short?t.SHORT:r===e.Int?t.INT:r===e.Float?t.FLOAT:r===e.UnsignedByte?t.UNSIGNED_BYTE:r===e.UnsignedShort?t.UNSIGNED_SHORT:r===e.UnsignedInt?t.UNSIGNED_INT:void 0}}]),e}();a.ArrayBuffer=1,a.ElementArrayBuffer=2,a.StaticDraw=10,a.DynamicDraw=11,a.Float=20,a.UnsignedByte=21,a.UnsignedShort=22,a.UnsignedInt=23,a.Byte=24,a.Short=25,a.Int=26,a.defaultOptions={itemSize:3,dataType:a.Float,stride:0,offset:0,normalized:!1},r.default=a,t.exports=r.default},{}],13:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=e("./Buffer"),u=n(o),s=function(){function e(t){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];i(this,e),this._buffer=t,this.options=Object.assign({},u.default.defaultOptions,r)}return a(e,[{key:"bind",value:function(e,t){this._buffer.bind(e,t,this.options)}}]),e}();r.default=s,t.exports=r.default},{"./Buffer":12}],14:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=e("gl-matrix"),u=e("./GeometryBuffer"),s=n(u),l=e("./math/Box"),c=n(l),f=function(){function e(){i(this,e),this.buffers={},this._boundingBox=null}return a(e,[{key:"setBuffer",value:function(e,t){return this.buffers[e]=t,this}},{key:"getBuffer",value:function(e){return this.buffers[e]}},{key:"computeNormals",value:function(){var e=this.buffers.position;if(!e)return this;for(var t=new Float32Array(e.length*e.options.itemSize),r=o.vec3.create(),n=o.vec3.create(),i=o.vec3.create(),a=0;a<e.length;a+=3){var u=e.getTriangle(a/3);o.vec3.sub(r,u[0],u[1]),o.vec3.sub(n,u[2],u[1]),o.vec3.cross(i,r,n),o.vec3.normalize(i,i),t.set(i,3*a),t.set(i,3*(a+1)),t.set(i,3*(a+2))}return this.setBuffer("normal",new s.default(t,{itemSize:3})),this}},{key:"getBoundingBox",value:function(){return this._boundingBox||this.computeBoundingBox(),this._boundingBox}},{key:"computeBoundingBox",value:function(){var e=this._boundingBox=new c.default,t=this.buffers.position;if(t)for(var r=0;r<t.length;r++)e.expandByPoint(t.getElement(r))}},{key:"concat",value:function(e){for(var t in this.buffers)this.buffers[t].concat(e.buffers[t])}}]),e}();r.default=f,t.exports=r.default},{"./GeometryBuffer":15,"./math/Box":45,"gl-matrix":2}],15:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("./Buffer"),l=n(s),c=function(e){function t(e,r){i(this,t);var n=a(this,Object.getPrototypeOf(t).call(this,e,r));return n._array=e,n.length=e.length/n.options.itemSize,n}return o(t,e),u(t,[{key:"getArray",value:function(){return this._array}},{key:"getElement",value:function(e){return this._array.subarray(e*this.options.itemSize,(e+1)*this.options.itemSize)}},{key:"getTriangle",value:function(e){return e*=3,[this.getElement(e),this.getElement(e+1),this.getElement(e+2)]}},{key:"concat",value:function(e){var t=e.getArray(),r=new this._array.constructor(this._array.length+t.length);return r.set(this._array,0),r.set(t,this._array.length),this._array=r,this.length=r.length/this.options.itemSize,this}}]),t}(l.default);r.default=c,t.exports=r.default},{"./Buffer":12}],16:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("./Object3D"),l=n(s),c=e("./libConstants"),f=function(e){function t(e,r){i(this,t);var n=a(this,Object.getPrototypeOf(t).call(this));return n.geometry=e,n.material=r,n.renderOrder=0,n.type=c.MESH,n}return o(t,e),u(t,[{key:"render",value:function(e){var t=e.gl;return this.visible?(this.worldMatrixNeedsUpdate&&this.updateWorldMatrix(),e.object=this,this.material.enable(e),t.drawArrays(t.TRIANGLES,0,this.geometry.getBuffer("position").length),this.material.disable(t),this):this}},{key:"typifyForRender",value:function(e){return this.visible?(this.material.typifyForRender(e,this),this.children.forEach(function(t){return t.typifyForRender(e)}),this):this}}]),t}(l.default);r.default=f,t.exports=r.default},{"./Object3D":18,"./libConstants":35}],17:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("./Object3D"),l=n(s),c=e("./Geometry"),f=n(c),h=e("./GeometryBuffer"),d=n(h),p=e("./libConstants"),v=function(e){function t(e,r){i(this,t);var n=a(this,Object.getPrototypeOf(t).call(this));return n.material=r,n.type=p.MULTI_SPRITE,n._initArrays(e),n._initGeometry(),n}return o(t,e),u(t,[{key:"setOpacity",value:function(e,t){var r=this._data.colorAlpha.array,n=6*e;return r[n]=t,r[n+1]=t,r[n+2]=t,r[n+3]=t,r[n+4]=t,r[n+5]=t,this._data.colorAlpha.dirty=!0,this}},{key:"setPosition",value:function(e,t){var r=this._data.position.array,n=18*e;return r[n]=t[0],r[n+1]=t[1],r[n+3]=t[0],r[n+4]=t[1],r[n+6]=t[0],r[n+7]=t[1],r[n+9]=t[0],r[n+10]=t[1],r[n+12]=t[0],r[n+13]=t[1],r[n+15]=t[0],r[n+16]=t[1],this._data.position.dirty=!0,this}},{key:"setElevation",value:function(e,t){var r=this._data.position.array,n=18*e;return r[n+2]=t,r[n+5]=t,r[n+8]=t,r[n+11]=t,r[n+14]=t,r[n+17]=t,this._data.position.dirty=!0,this}},{key:"setSize",value:function(e,t){var r=this._data.scale.array,n=12*e;return r[n]=t[0],r[n+1]=t[1],r[n+2]=t[0],r[n+3]=t[1],r[n+4]=t[0],r[n+5]=t[1],r[n+6]=t[0],r[n+7]=t[1],r[n+8]=t[0],r[n+9]=t[1],r[n+10]=t[0],r[n+11]=t[1],this._data.scale.dirty=!0,this}},{key:"setOffset",value:function(e,t){var r=this._data.offset.array,n=12*e;return r[n]=t[0],r[n+1]=t[1],r[n+2]=t[0],r[n+3]=t[1],r[n+4]=t[0],r[n+5]=t[1],r[n+6]=t[0],r[n+7]=t[1],r[n+8]=t[0],r[n+9]=t[1],r[n+10]=t[0],r[n+11]=t[1],this._data.offset.dirty=!0,this}},{key:"setUV",value:function(e,t){var r=this._data.texture.array,n=12*e;return r[n]=t[2],r[n+1]=1-t[3],r[n+2]=t[2],r[n+3]=1-t[1],r[n+4]=t[0],r[n+5]=1-t[3],r[n+6]=t[0],r[n+7]=1-t[1],r[n+8]=t[0],r[n+9]=1-t[3],r[n+10]=t[2],r[n+11]=1-t[1],this._data.texture.dirty=!0,this}},{key:"render",value:function(e){var t=e.gl,r=e.shaderProgram,n=this._geometry;r.bind(t,null,{texture:n.getBuffer("texture"),position:n.getBuffer("position"),colorAlpha:n.getBuffer("colorAlpha"),scale:n.getBuffer("scale"),offset:n.getBuffer("offset"),disposition:n.getBuffer("disposition")});for(var i in this._data)this._data[i].dirty&&(this._geometry.getBuffer(i).subData(t,0,this._data[i].array),this._data[i].dirty=!1);return this.material.enable(e),t.drawArrays(t.TRIANGLES,0,this._geometry.getBuffer("disposition").length),this.material.disable(),this}},{key:"typifyForRender",value:function(e){return this.visible&&this.material.getTexture()?(e[p.MULTI_SPRITE_RENDERER].addObject(this),this.children.forEach(function(t){return t.typifyForRender(e)}),this):this}},{key:"_initArrays",value:function(e){var t=e.length,r=[.5,-.5,0,.5,.5,0,-.5,-.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0],n=new Float32Array(18*t),i=new Float32Array(12*t),a=new Float32Array(18*t),o=new Float32Array(12*t),u=new Float32Array(12*t),s=new Float32Array(6*t);this._data={disposition:{array:n,dirty:!1},texture:{array:i,dirty:!1},position:{array:a,dirty:!1},scale:{array:o,dirty:!1},offset:{array:u,dirty:!1},colorAlpha:{array:s,dirty:!1}};for(var l=0;l<t;l++){var c=e[l];n.set(r,18*l),this.setUV(l,c.uv||[0,0,1,1]),this.setSize(l,c.size||[0,0]),this.setOffset(l,c.offset||[0,0]),this.setOpacity(l,void 0!==c.opacity?c.opacity:1),this.setPosition(l,c.position),this.setElevation(l,c.elevation||0)}}},{key:"_initGeometry",value:function(){this._geometry=new f.default;var e=new d.default(this._data.texture.array,{itemSize:2});e.drawType=d.default.DynamicDraw;var t=new d.default(this._data.position.array,{itemSize:3});t.drawType=d.default.DynamicDraw;var r=new d.default(this._data.scale.array,{itemSize:2});r.drawType=d.default.DynamicDraw;var n=new d.default(this._data.offset.array,{itemSize:2});n.drawType=d.default.DynamicDraw;var i=new d.default(this._data.colorAlpha.array,{itemSize:1});i.drawType=d.default.DynamicDraw;var a=new d.default(this._data.disposition.array,{itemSize:3});this._geometry.setBuffer("disposition",a).setBuffer("texture",e).setBuffer("position",t).setBuffer("scale",r).setBuffer("offset",n).setBuffer("colorAlpha",i)}}]),t}(l.default);r.default=v,t.exports=r.default},{"./Geometry":14,"./GeometryBuffer":15,"./Object3D":18,"./libConstants":35}],18:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("gl-matrix"),o=e("./libConstants"),u=function(){function e(){n(this,e),this.children=[],this.parent=null,this.visible=!0,this.scale=a.vec3.fromValues(1,1,1),this.position=a.vec3.create(),this.quaternion=a.quat.create(),this.localMatrix=a.mat4.create(),this.worldMatrix=a.mat4.create(),this.worldMatrixNeedsUpdate=!1,this.type=o.OBJECT_3D}return i(e,[{key:"add",value:function(e){return e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),this}},{key:"remove",value:function(e){var t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1)),this}},{key:"render",value:function(e){return this.visible?(this.worldMatrixNeedsUpdate&&this.updateWorldMatrix(),this):this}},{key:"updateLocalMatrix",value:function(){return a.mat4.fromRotationTranslationScale(this.localMatrix,this.quaternion,this.position,this.scale),this.worldMatrixNeedsUpdate=!0,this}},{key:"updateWorldMatrix",value:function(){return this.parent?a.mat4.mul(this.worldMatrix,this.parent.worldMatrix,this.localMatrix):a.mat4.copy(this.worldMatrix,this.localMatrix),this.children.forEach(function(e){return e.updateWorldMatrix()}),this.worldMatrixNeedsUpdate=!1,this}},{key:"getWorldPosition",value:function(){return a.vec3.fromValues(this.worldMatrix[12],this.worldMatrix[13],this.worldMatrix[14])}},{key:"traverse",value:function(e){return e(this),this.children.forEach(function(t){return t.traverse(e)}),this}},{key:"traverseVisible",value:function(e){return this.visible?(e(this),this.children.forEach(function(t){return t.traverseVisible(e)}),this):this}},{key:"typifyForRender",value:function(e){return this.visible?(e[o.OBJECT_3D_RENDERER].addObject(this),this.children.forEach(function(t){return t.typifyForRender(e)}),this):this}}]),e}();r.default=u,t.exports=r.default},{"./libConstants":35,"gl-matrix":2}],19:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("gl-matrix"),s=e("./math/Ray"),l=n(s),c=e("./libConstants"),f=function(){function e(t,r,n,o){a(this,e),this.precision=1e-4,this.ray=new l.default(t,r),this.near=n||0,this.far=o||1/0,this.intersectMethodsByType=i({},c.MESH,"intersectMesh"),this._vec3=u.vec3.create(),this._mat3=u.mat3.create()}return o(e,[{key:"setFromCamera",value:function(e,t){if(t.type===c.PERSPECTIVE_CAMERA){u.vec3.copy(this.ray.origin,t.position);var r=u.vec3.set(this._vec3,e[0],e[1],.5);r=t.unproject(r),u.vec3.sub(r,r,t.position),u.vec3.normalize(r,r),this.ray.direction=r}else if(t.type===c.ORTHOGRAPHIC_CAMERA){var n=u.vec3.set(this._vec3,e[0],e[1],-1);this.ray.origin=t.unproject(n),u.vec3.set(this.ray.direction,0,0,-1),u.mat3.fromMat4(this._mat3,t.worldMatrix),u.vec3.transformMat3(this.ray.direction,this.ray.direction,this._mat3),u.vec3.normalize(this.ray.direction,this.ray.direction)}}},{key:"intersectObject",value:function(e,t,r){r=r||[];var n=this.intersectMethodsByType[e.type];return n&&this[n]?this[n](e,t,r):t&&this.intersectObjects(e.children,t,r),r.sort(this._descSort),r}},{key:"intersectObjects",value:function(e,t,r){var n=this;return r=r||[],e.forEach(function(e){return n.intersectObject(e,t,r)}),r}},{key:"intersectMesh",value:function(e,t,r){r=r||[];var n=u.mat4.create();u.mat4.invert(n,e.worldMatrix);var i=this.ray.clone();i.applyMatrix4(n);var a=e.geometry.getBoundingBox();if(!i.intersectBox(a))return e;for(var o=e.geometry.buffers.position,s=0;s<o.length;s+=3){var l=o.getTriangle(s/3),c=i.intersectTriangle(l,!1);if(c){u.vec3.transformMat4(c,c,e.worldMatrix);var f=u.vec3.dist(this.ray.origin,c);f<this.precision||f<this.near||f>this.far||r.push({distance:f,point:c,object:e})}}return t&&this.intersectObjects(e.children,t,r),r}},{key:"_descSort",value:function(e,t){return e.distance-t.distance}}]),e}();r.default=f,t.exports=r.default},{"./libConstants":35,"./math/Ray":50,"gl-matrix":2}],20:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=e("./Texture"),u=n(o),s=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];i(this,e),this._size=t.size}return a(e,[{key:"bind",value:function(e){return this._sizeChanged&&(this._unprepare(e),this._sizeChanged=!1),this._frameBuffer||this._prepare(e),e.bindFramebuffer(e.FRAMEBUFFER,this._frameBuffer),this}},{key:"unbind",value:function(e){return e.bindFramebuffer(e.FRAMEBUFFER,null),this}},{key:"remove",value:function(e){return this._unprepare(e),this}},{key:"setSize",value:function(e){return this._size=e,this._sizeChanged=!0,this}},{key:"_prepare",value:function(e){this._texture=new u.default,this._texture.generateMipmaps=!1,this._texture.size=this._size,this._texture._prepare(e),this._frameBuffer=e.createFramebuffer(),e.bindFramebuffer(e.FRAMEBUFFER,this._frameBuffer),this._renderBuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,this._renderBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,this._size[0],this._size[1]),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._texture._texture,0),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this._renderBuffer),this._checkComplete(e),e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null)}},{key:"_unprepare",value:function(e){this._frameBuffer&&(this._texture.remove(e),e.deleteFramebuffer(this._frameBuffer),e.deleteRenderbuffer(this._renderBuffer),this._frameBuffer=null)}},{key:"_checkComplete",value:function(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);t!==e.FRAMEBUFFER_COMPLETE&&(t===e.FRAMEBUFFER_UNSUPPORTED?console.log("Framebuffer is unsupported"):t===e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT?console.log("Framebuffer incomplete attachment"):t===e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS?console.log("Framebuffer incomplete dimensions"):t===e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT?console.log("Framebuffer incomplete missing attachment"):console.log("Unexpected framebuffer status: "+t))}}]),e}();r.default=s,t.exports=r.default},{"./Texture":29}],21:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=e("./rendererPlugins/Object3DPlugin"),u=n(o),s=function(){function e(t){if(i(this,e),t=t||{},t.canvas){this._canvasElement="string"==typeof t.canvas?document.getElementById(t.canvas):t.canvas;var r={antialias:void 0===t.antialias||t.antialias};this._gl=this._canvasElement.getContext("webgl",r)||this._canvasElement.getContext("experimental-webgl",r)}else this._gl=t.gl;this._pixelRatio=t.pixelRatio||1,this.autoClear=void 0===t.autoClear||t.autoClear,this.clearColor=t.clearColor||[1,1,1,1],this.sortObjects=!0,this._plugins=[],this._pluginsByType={},this._maxPluginOrder=0,this.addPlugin(new u.default,0),this.webGlExtensions={}}return a(e,[{key:"addPlugin",value:function(e,t){return void 0===t&&(t=this._maxPluginOrder+1),this._plugins.push({plugin:e,order:t}),this._plugins.sort(function(e,t){return e.order-t.order}),this._pluginsByType[e.type]=e,this._maxPluginOrder=Math.max.apply(Math,this._plugins.map(function(e){return e.order})),this}},{key:"removePlugin",value:function(e){var t=this;return this._plugins.some(function(r,n){if(r.plugin instanceof e)return delete t._pluginsByType[t._plugins[n].plugin.type],t._plugins.splice(n,1),!0}),this}},{key:"setPixelRatio",value:function(e){return this._pixelRatio=e,this}},{key:"getPixelRatio",value:function(){return this._pixelRatio}},{key:"setSize",value:function(e,t){return this._size=[e*this._pixelRatio,t*this._pixelRatio],this._canvasElement&&(this._canvasElement.width=this._size[0],this._canvasElement.height=this._size[1],this._canvasElement.style.width=e+"px",this._canvasElement.style.height=t+"px"),this.setViewport(),this}},{key:"setViewport",value:function(e,t){return void 0!==e&&void 0!==t?this._gl.viewport(0,0,e,t):this._gl.viewport(0,0,this._size[0],this._size[1]),this}},{key:"getSize",value:function(){return this._size}},{key:"setRenderTarget",value:function(e){return this._renderTarget=e,this}},{key:"readPixels",value:function(e,t,r,n,i){var a=this._gl;return this._renderTarget?(this._renderTarget.bind(a),a.readPixels(e,t,r,n,a.RGBA,a.UNSIGNED_BYTE,i),this._renderTarget.unbind(a)):a.readPixels(e,t,r,n,a.RGBA,a.UNSIGNED_BYTE,i),this}},{key:"clear",value:function(){var e=this._gl;return e.clearColor.apply(e,this.clearColor),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),this}},{key:"render",value:function(e,t,r){var n=this._gl;e.typifyForRender(this._pluginsByType),this._renderTarget&&this._renderTarget.bind(n),n.clearDepth(1),n.clearStencil(0),this.autoClear&&this.clear(),t.updateLocalMatrix(),t.updateWorldMatrix();var i={renderer:this,extensions:this.webGlExtensions,scene:e,camera:t,gl:n,userData:r};return this._plugins.forEach(function(e){e.plugin.hasObjects()&&e.plugin.render(i)}),this._renderTarget&&this._renderTarget.unbind(n),this}},{key:"addExtension",value:function(e){return this.webGlExtensions[e]=this._gl.getExtension(e),this}}]),e}();r.default=s,t.exports=r.default},{"./rendererPlugins/Object3DPlugin":53}],22:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){n(this,e),this._objects=[],this.type=0}return i(e,[{key:"render",value:function(){this._objects=[]}},{key:"addObject",value:function(e){return this._objects.push(e),this}},{key:"hasObjects",value:function(){return this._objects.length>0}}]),e}();r.default=a,t.exports=r.default},{}],23:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("./Object3D"),l=n(s),c=function(e){function t(){i(this,t);var e=a(this,Object.getPrototypeOf(t).call(this));return e._lights=[],e}return o(t,e),u(t,[{key:"addLight",value:function(e){return this._lights.push(e),this}},{key:"getLights",value:function(){return this._lights}}]),t}(l.default);r.default=c,t.exports=r.default},{"./Object3D":18}],24:[function(e,t,r){(function(e){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function t(e,r){var i=arguments.length<=2||void 0===arguments[2]?[]:arguments[2];n(this,t),this.type="vertex"===e?t.Vertex:t.Fragment,this._code=Array.isArray(r)?r.join("\n"):r||"",this._code=i.map(function(e){return void 0!==e.value?"#define "+e.type+" "+e.value:"#define "+e.type}).join("\n")+"\n"+this._code}return i(t,[{key:"get",value:function(e){return this._shader||this._compile(e),this._shader}},{key:"remove",value:function(e){this._shader&&e.deleteShader(this._shader)}},{key:"_compile",value:function(r){var n=this.type===t.Vertex?r.VERTEX_SHADER:r.FRAGMENT_SHADER,i=this._shader=r.createShader(n);r.shaderSource(i,this._code),r.compileShader(i),"production"===e.env.NODE_ENV||r.getShaderParameter(i,r.COMPILE_STATUS)||console.log(r.getShaderInfoLog(i))}}]),t}();a.Vertex=1,a.Fragment=2,r.default=a,t.exports=r.default}).call(this,e("_process"))},{_process:1}],25:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t){n(this,e),this.name=t.name,this.index=t.index,this.location=-1,this._enable=!1}return i(e,[{key:"setLocation",value:function(e,t){return this.location=e.getAttribLocation(t,this.name),this}},{key:"bind",value:function(e,t){return this._enable||this.index===!0||(e.enableVertexAttribArray(this.location),this._enable=!0),t.bind(e,this.location),this}},{key:"disable",value:function(e){return this._enable&&this.index!==!0&&(e.disableVertexAttribArray(this.location),this._enable=!1),this}}]),e}();r.default=a,t.exports=r.default},{}],26:[function(e,t,r){(function(n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("./ShaderAttribute"),s=i(u),l=e("./ShaderUniform"),c=i(l),f=function(){function e(t){var r=this;a(this,e),t=t||{},this._vertexShader=t.vertex,this._fragmentShader=t.fragment,this.uniforms={},t.uniforms=t.uniforms||[],t.uniforms.forEach(function(e){r.uniforms[e.name]=new c.default(e)}),this.attributes={},t.attributes=t.attributes||[],t.attributes.forEach(function(e){r.attributes[e.name]=new s.default(e)}),this._status=e.NOT_READY}return o(e,[{key:"enable",value:function(t){return this._status===e.NOT_READY&&this._prepare(t),this._status!==e.READY?this:(t.useProgram(this._webglProgram),this)}},{key:"bind",value:function(e,t,r){
if(t)for(var n in t)this.uniforms[n].bind(e,t[n]);if(r)for(var i in r)this.attributes[i].bind(e,r[i]);return this}},{key:"disable",value:function(e){for(var t in this.attributes)this.attributes[t].disable(e);return this}},{key:"_prepare",value:function(t){if(this._webglProgram=t.createProgram(),this._vertexShader&&t.attachShader(this._webglProgram,this._vertexShader.get(t)),this._fragmentShader&&t.attachShader(this._webglProgram,this._fragmentShader.get(t)),t.linkProgram(this._webglProgram),"production"!==n.env.NODE_ENV&&!t.getProgramParameter(this._webglProgram,t.LINK_STATUS))return console.log("Could not initialize shaders"),void(this._status=e.FAILED);this._status=e.READY;for(var r in this.attributes)this.attributes[r].setLocation(t,this._webglProgram);for(var i in this.uniforms)this.uniforms[i].setLocation(t,this._webglProgram)}}]),e}();f.NOT_READY=1,f.READY=2,f.FAILED=3,r.default=f,t.exports=r.default}).call(this,e("_process"))},{"./ShaderAttribute":25,"./ShaderUniform":27,_process:1}],27:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t){n(this,e),this.name=t.name,this.type=t.type,this.location=-1}return i(e,[{key:"setLocation",value:function(e,t){return this.location=e.getUniformLocation(t,this.name),this}},{key:"bind",value:function(e,t){var r=this.type;return"mat2"===r?e.uniformMatrix2fv(this.location,!1,t):"mat3"===r?e.uniformMatrix3fv(this.location,!1,t):"mat4"===r?e.uniformMatrix4fv(this.location,!1,t):"2f"===r?e.uniform2f(this.location,t[0],t[1]):"3f"===r?e.uniform3f(this.location,t[0],t[1],t[2]):"4f"===r?e.uniform4f(this.location,t[0],t[1],t[2],t[3]):"2i"===r?e.uniform2i(this.location,t[0],t[1]):"3i"===r?e.uniform3i(this.location,t[0],t[1],t[2]):"4i"===r?e.uniform4i(this.location,t[0],t[1],t[2],t[3]):e["uniform"+r](this.location,t),this}}]),e}();r.default=a,t.exports=r.default},{}],28:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("./Object3D"),l=n(s),c=e("gl-matrix"),f=e("./libConstants"),h=function(e){function t(e){i(this,t);var r=a(this,Object.getPrototypeOf(t).call(this));return r.material=e,r.offset=c.vec2.create(),r.type=f.SPRITE,r}return o(t,e),u(t,[{key:"render",value:function(e){if(!this.visible||!this.material.getTexture())return this;this.worldMatrixNeedsUpdate&&this.updateWorldMatrix();var t=e.gl;return e.object=this,this.material.enable(e),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),this.material.disable(e.gl),this}},{key:"typifyForRender",value:function(e){return this.visible?(e[f.SPRITE_RENDERER].addObject(this),this.children.forEach(function(t){return t.typifyForRender(e)}),this):this}}]),t}(l.default);r.default=h,t.exports=r.default},{"./Object3D":18,"./libConstants":35,"gl-matrix":2}],29:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t){n(this,e),this._src=t||null,this.magFilter=e.LinearFilter,this.minFilter=e.LinearMipMapLinearFilter,this.wrapS=e.ClampToEdgeWrapping,this.wrapT=e.ClampToEdgeWrapping,this.format=e.RgbaFormat,this.generateMipmaps=!0,this.flipY=!0,this.premultiplyAlpha=!0}return i(e,[{key:"enable",value:function(e,t){return void 0!==t&&e.activeTexture(e.TEXTURE0+t),this._texture||this._prepare(e),e.bindTexture(e.TEXTURE_2D,this._texture),this}},{key:"remove",value:function(e){return this._texture&&e.deleteTexture(this._texture),this}},{key:"_prepare",value:function(t){this._texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this._texture),this.flipY&&t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),this.premultiplyAlpha&&t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),this.size?t.texImage2D(t.TEXTURE_2D,0,this._toGlParam(t,this.format),this.size[0],this.size[1],0,this._toGlParam(t,this.format),t.UNSIGNED_BYTE,this._src):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this._src),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,this._toGlParam(t,this.wrapS)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,this._toGlParam(t,this.wrapT)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,this._toGlParam(t,this.magFilter)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,this._toGlParam(t,this.minFilter)),this.generateMipmaps&&this.minFilter!==e.NearestFilter&&this.minFilter!==e.LinearFilter&&t.generateMipmap(t.TEXTURE_2D),t.bindTexture(t.TEXTURE_2D,null)}},{key:"_toGlParam",value:function(t,r){return r===e.ClampToEdgeWrapping?t.CLAMP_TO_EDGE:r===e.Repeat?t.REPEAT:r===e.MirroredRepeat?t.MIRRORED_REPEAT:r===e.NearestFilter?t.NEAREST:r===e.NearestMipMapNearestFilter?t.NEAREST_MIPMAP_NEAREST:r===e.NearestMipMapLinearFilter?t.NEAREST_MIPMAP_LINEAR:r===e.LinearFilter?t.LINEAR:r===e.LinearMipMapNearestFilter?t.LINEAR_MIPMAP_NEAREST:r===e.LinearMipMapLinearFilter?t.LINEAR_MIPMAP_LINEAR:r===e.RgbaFormat?t.RGBA:r===e.AlphaFormat?t.ALPHA:void 0}}]),e}();a.ClampToEdgeWrapping=8,a.Repeat=9,a.MirroredRepeat=10,a.NearestFilter=1,a.NearestMipMapNearestFilter=2,a.NearestMipMapLinearFilter=3,a.LinearFilter=4,a.LinearMipMapNearestFilter=5,a.LinearMipMapLinearFilter=6,a.RgbaFormat=11,a.AlphaFormat=12,r.default=a,t.exports=r.default},{}],30:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];n(this,e),this._vao=null,this._attributes=r,this._shaderProgram=t,this._ext=null}return i(e,[{key:"bind",value:function(e){var t=e.extensions.OES_vertex_array_object;return t?this._bind(e.gl,t):this._shaderProgram.bind(e.gl,null,this._attributes),this}},{key:"unbind",value:function(e){var t=e.extensions.OES_vertex_array_object;return t&&t.bindVertexArrayOES(null),this}},{key:"remove",value:function(){return this._vao&&this._ext.deleteVertexArrayOES(this._vao),this}},{key:"_bind",value:function(e,t){this._vao?t.bindVertexArrayOES(this._vao):this._prepare(e,t)}},{key:"_prepare",value:function(e,t){this._ext=t,this._vao=t.createVertexArrayOES(),t.bindVertexArrayOES(this._vao);var r=this._shaderProgram.attributes,n=this._attributes;for(var i in n){var a=r[i];a.index!==!0&&e.enableVertexAttribArray(a.location),n[i].bind(e,a.location)}}}]),e}();r.default=a,t.exports=r.default},{}],31:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,r,n)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(n)},l=e("../Object3D"),c=n(l),f=e("gl-matrix"),h=function(e){function t(){i(this,t);var e=a(this,Object.getPrototypeOf(t).call(this));return e.up=f.vec3.fromValues(0,1,0),e.projectionMatrix=f.mat4.create(),e.modelViewMatrix=f.mat4.create(),e.worldInverseMatrix=f.mat4.create(),e._mat3=f.mat3.create(),e._mat4a=f.mat4.create(),e._mat4b=f.mat4.create(),e}return o(t,e),u(t,[{key:"updateProjectionMatrix",value:function(){}},{key:"updateWorldMatrix",value:function(){s(Object.getPrototypeOf(t.prototype),"updateWorldMatrix",this).call(this),f.mat4.invert(this.worldInverseMatrix,this.worldMatrix),f.mat4.multiply(this.modelViewMatrix,this.projectionMatrix,this.worldInverseMatrix)}},{key:"project",value:function(e){var t=f.vec3.create();return f.vec3.transformMat4(t,e,this.modelViewMatrix),t}},{key:"unproject",value:function(e){var t=this._mat4a,r=this._mat4b,n=f.vec3.create();return f.mat4.invert(r,this.projectionMatrix),f.mat4.mul(t,this.worldMatrix,r),f.vec3.transformMat4(n,e,t),n}},{key:"lookAt",value:function(e){var t=this._mat4a,r=this._mat3;return f.mat4.lookAt(t,this.position,e,this.up),f.mat4.transpose(t,t),f.mat3.fromMat4(r,t),f.quat.fromMat3(this.quaternion,r),this}}]),t}(c.default);r.default=h,t.exports=r.default},{"../Object3D":18,"gl-matrix":2}],32:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("gl-matrix"),l=e("./Camera"),c=n(l),f=e("../libConstants"),h=function(e){function t(e,r,n,o,u,s){i(this,t);var l=a(this,Object.getPrototypeOf(t).call(this));return l.left=e,l.right=r,l.top=n,l.bottom=o,l.near=u,l.far=s,l.type=f.ORTHOGRAPHIC_CAMERA,l}return o(t,e),u(t,[{key:"updateProjectionMatrix",value:function(){s.mat4.ortho(this.projectionMatrix,this.left,this.right,this.bottom,this.top,this.near,this.far)}}]),t}(c.default);r.default=h,t.exports=r.default},{"../libConstants":35,"./Camera":31,"gl-matrix":2}],33:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("gl-matrix"),l=e("./Camera"),c=n(l),f=e("../math/Math"),h=e("../libConstants"),d=function(e){function t(e,r,n,o){i(this,t);var u=a(this,Object.getPrototypeOf(t).call(this));return u.fov=e,u.aspect=r,u.near=n,u.far=o,u.type=h.PERSPECTIVE_CAMERA,u}return o(t,e),u(t,[{key:"updateProjectionMatrix",value:function(){s.mat4.perspective(this.projectionMatrix,(0,f.degToRad)(this.fov),this.aspect,this.near,this.far)}}]),t}(c.default);r.default=d,t.exports=r.default},{"../libConstants":35,"../math/Math":48,"./Camera":31,"gl-matrix":2}],34:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.Math=r.glMatrix=r.quat=r.mat4=r.vec2=r.mat3=r.vec3=r.Vao=r.TransparentPlugin=r.RenderTarget=r.Raycaster=r.Ray=r.Texture=r.SpritePlugin=r.SpriteMaterial=r.Sprite=r.ShaderProgram=r.Shader=r.Scene=r.RendererPlugin=r.Renderer=r.Plane=r.PerspectiveCamera=r.OrthographicCamera=r.Object3DPlugin=r.Object3D=r.MultiSpritePlugin=r.MultiSpriteMaterial=r.MultiSprite=r.Line3=r.libConstants=r.Mesh=r.Geometry=r.Frustum=r.DirectionalLight=r.ComplexMeshMaterial=r.CommonPlugin=r.Box=r.GeometryBuffer=r.BufferChannel=r.Buffer=r.BasicMeshMaterial=r.AmbientLight=void 0;var a=e("./lights/AmbientLight");Object.defineProperty(r,"AmbientLight",{enumerable:!0,get:function(){return i(a).default}});var o=e("./materials/BasicMeshMaterial");Object.defineProperty(r,"BasicMeshMaterial",{enumerable:!0,get:function(){return i(o).default}});var u=e("./Buffer");Object.defineProperty(r,"Buffer",{enumerable:!0,get:function(){return i(u).default}});var s=e("./BufferChannel");Object.defineProperty(r,"BufferChannel",{enumerable:!0,get:function(){return i(s).default}});var l=e("./GeometryBuffer");Object.defineProperty(r,"GeometryBuffer",{enumerable:!0,get:function(){return i(l).default}});var c=e("./math/Box");Object.defineProperty(r,"Box",{enumerable:!0,get:function(){return i(c).default}});var f=e("./rendererPlugins/CommonPlugin");Object.defineProperty(r,"CommonPlugin",{enumerable:!0,get:function(){return i(f).default}});var h=e("./materials/ComplexMeshMaterial");Object.defineProperty(r,"ComplexMeshMaterial",{enumerable:!0,get:function(){return i(h).default}});var d=e("./lights/DirectionalLight");Object.defineProperty(r,"DirectionalLight",{enumerable:!0,get:function(){return i(d).default}});var p=e("./math/Frustum");Object.defineProperty(r,"Frustum",{enumerable:!0,get:function(){return i(p).default}});var v=e("./Geometry");Object.defineProperty(r,"Geometry",{enumerable:!0,get:function(){return i(v).default}});var m=e("./Mesh");Object.defineProperty(r,"Mesh",{enumerable:!0,get:function(){return i(m).default}});var y=e("./libConstants");Object.defineProperty(r,"libConstants",{enumerable:!0,get:function(){return i(y).default}});var b=e("./math/Line3");Object.defineProperty(r,"Line3",{enumerable:!0,get:function(){return i(b).default}});var g=e("./MultiSprite");Object.defineProperty(r,"MultiSprite",{enumerable:!0,get:function(){return i(g).default}});var _=e("./materials/MultiSpriteMaterial");Object.defineProperty(r,"MultiSpriteMaterial",{enumerable:!0,get:function(){return i(_).default}});var P=e("./rendererPlugins/MultiSpritePlugin");Object.defineProperty(r,"MultiSpritePlugin",{enumerable:!0,get:function(){return i(P).default}});var M=e("./Object3D");Object.defineProperty(r,"Object3D",{enumerable:!0,get:function(){return i(M).default}});var E=e("./rendererPlugins/Object3DPlugin");Object.defineProperty(r,"Object3DPlugin",{enumerable:!0,get:function(){return i(E).default}});var x=e("./cameras/OrthographicCamera");Object.defineProperty(r,"OrthographicCamera",{enumerable:!0,get:function(){return i(x).default}});var O=e("./cameras/PerspectiveCamera");Object.defineProperty(r,"PerspectiveCamera",{enumerable:!0,get:function(){return i(O).default}});var w=e("./math/Plane");Object.defineProperty(r,"Plane",{enumerable:!0,get:function(){return i(w).default}});var T=e("./Renderer");Object.defineProperty(r,"Renderer",{enumerable:!0,get:function(){return i(T).default}});var j=e("./RendererPlugin");Object.defineProperty(r,"RendererPlugin",{enumerable:!0,get:function(){return i(j).default}});var R=e("./Scene");Object.defineProperty(r,"Scene",{enumerable:!0,get:function(){return i(R).default}});var A=e("./Shader");Object.defineProperty(r,"Shader",{enumerable:!0,get:function(){return i(A).default}});var C=e("./ShaderProgram");Object.defineProperty(r,"ShaderProgram",{enumerable:!0,get:function(){return i(C).default}});var S=e("./Sprite");Object.defineProperty(r,"Sprite",{enumerable:!0,get:function(){return i(S).default}});var k=e("./materials/SpriteMaterial");Object.defineProperty(r,"SpriteMaterial",{enumerable:!0,get:function(){return i(k).default}});var D=e("./rendererPlugins/SpritePlugin");Object.defineProperty(r,"SpritePlugin",{enumerable:!0,get:function(){return i(D).default}});var B=e("./Texture");Object.defineProperty(r,"Texture",{enumerable:!0,get:function(){return i(B).default}});var L=e("./math/Ray");Object.defineProperty(r,"Ray",{enumerable:!0,get:function(){return i(L).default}});var F=e("./Raycaster");Object.defineProperty(r,"Raycaster",{enumerable:!0,get:function(){return i(F).default}});var N=e("./RenderTarget");Object.defineProperty(r,"RenderTarget",{enumerable:!0,get:function(){return i(N).default}});var I=e("./rendererPlugins/TransparentPlugin");Object.defineProperty(r,"TransparentPlugin",{enumerable:!0,get:function(){return i(I).default}});var U=e("./Vao");Object.defineProperty(r,"Vao",{enumerable:!0,get:function(){return i(U).default}});var z=e("gl-matrix");Object.defineProperty(r,"vec3",{enumerable:!0,get:function(){return z.vec3}}),Object.defineProperty(r,"mat3",{enumerable:!0,get:function(){return z.mat3}}),Object.defineProperty(r,"vec2",{enumerable:!0,get:function(){return z.vec2}}),Object.defineProperty(r,"mat4",{enumerable:!0,get:function(){return z.mat4}}),Object.defineProperty(r,"quat",{enumerable:!0,get:function(){return z.quat}}),Object.defineProperty(r,"glMatrix",{enumerable:!0,get:function(){return z.glMatrix}});var G=e("./math/Math"),Y=n(G);r.Math=Y,z.glMatrix.ARRAY_TYPE="undefined"!=typeof Float64Array?Float64Array:Array},{"./Buffer":12,"./BufferChannel":13,"./Geometry":14,"./GeometryBuffer":15,"./Mesh":16,"./MultiSprite":17,"./Object3D":18,"./Raycaster":19,"./RenderTarget":20,"./Renderer":21,"./RendererPlugin":22,"./Scene":23,"./Shader":24,"./ShaderProgram":26,"./Sprite":28,"./Texture":29,"./Vao":30,"./cameras/OrthographicCamera":32,"./cameras/PerspectiveCamera":33,"./libConstants":35,"./lights/AmbientLight":36,"./lights/DirectionalLight":37,"./materials/BasicMeshMaterial":39,"./materials/ComplexMeshMaterial":40,"./materials/MultiSpriteMaterial":42,"./materials/SpriteMaterial":43,"./math/Box":45,"./math/Frustum":46,"./math/Line3":47,"./math/Math":48,"./math/Plane":49,"./math/Ray":50,"./rendererPlugins/CommonPlugin":51,"./rendererPlugins/MultiSpritePlugin":52,"./rendererPlugins/Object3DPlugin":53,"./rendererPlugins/SpritePlugin":54,"./rendererPlugins/TransparentPlugin":55,"gl-matrix":2}],35:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.ORTHOGRAPHIC_CAMERA=1,r.PERSPECTIVE_CAMERA=2,r.AMBIENT_LIGHT=3,r.DIRECTIONAL_LIGHT=4,r.BASIC_MESH_MATERIAL=5,r.COMPLEX_MESH_MATERIAL=6,r.SPRITE_MATERIAL=7,r.MULTI_SPRITE_MATERIAL=8,r.MESH=9,r.SPRITE=10,r.MULTI_SPRITE=11,r.OBJECT_3D=12,r.COMMON_RENDERER=13,r.TRANSPARENT_RENDERER=14,r.SPRITE_RENDERER=15,r.MULTI_SPRITE_RENDERER=16,r.OBJECT_3D_RENDERER=17},{}],36:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var u=e("../libConstants"),s=e("./Light"),l=n(s),c=function(e){function t(e){i(this,t);var r=a(this,Object.getPrototypeOf(t).call(this,e));return r.type=u.AMBIENT_LIGHT,r}return o(t,e),t}(l.default);r.default=c,t.exports=r.default},{"../libConstants":35,"./Light":38}],37:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var u=e("../libConstants"),s=e("./Light"),l=n(s),c=function(e){function t(e){i(this,t);var r=a(this,Object.getPrototypeOf(t).call(this,e));return r.type=u.DIRECTIONAL_LIGHT,r}return o(t,e),t}(l.default);r.default=c,t.exports=r.default},{"../libConstants":35,"./Light":38}],38:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var u=e("../Object3D"),s=n(u),l=function(e){function t(e){i(this,t);var r=a(this,Object.getPrototypeOf(t).call(this));return r.color=e,r}return o(t,e),t}(s.default);r.default=l,t.exports=r.default},{"../Object3D":18}],39:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../shaders/basic.frag.glsl.js"),l=n(s),c=e("../shaders/basic.vert.glsl.js"),f=n(c),h=e("./Material"),d=n(h),p=e("../libConstants"),v={fragment:l.default,vertex:f.default},m=function(e){function t(){i(this,t);var e=a(this,Object.getPrototypeOf(t).call(this));return e._attributes=[{name:"position"}],e._uniforms=[{name:"uColorAlpha",type:"1f"},{name:"uCamera",type:"mat4"},{name:"uPosition",type:"mat4"},{name:"uColor",type:"3fv"}],e._shader=v,e.color=[0,0,0],e.type=p.BASIC_MESH_MATERIAL,e}return o(t,e),u(t,[{key:"_shaderProgramBind",value:function(e){var t=e.gl,r=e.object,n=e.camera,i={};this._attributes.forEach(function(e){i[e.name]=r.geometry.getBuffer(e.name)});var a={uColorAlpha:this.opacity,uPosition:new Float32Array(r.worldMatrix),uCamera:new Float32Array(n.modelViewMatrix),uColor:this.color};this._shaderProgram.bind(t,a,i)}}]),t}(d.default);r.default=m,t.exports=r.default},{"../libConstants":35,"../shaders/basic.frag.glsl.js":56,"../shaders/basic.vert.glsl.js":57,"./Material":41}],40:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,r,n)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(n)},l=e("../shaders/complex.frag.glsl.js"),c=n(l),f=e("../shaders/complex.vert.glsl.js"),h=n(f),d=e("gl-matrix"),p=e("./Material"),v=n(p),m=e("../libConstants"),y={fragment:c.default,vertex:h.default},b=function(e){function t(){i(this,t);var e=a(this,Object.getPrototypeOf(t).call(this));return e._attributes=[{name:"position"},{name:"color"},{name:"emissive"}],e._uniforms=[{name:"uColorAlpha",type:"1f"},{name:"uCamera",type:"mat4"},{name:"uPosition",type:"mat4"},{name:"uAmbientLightColor",type:"3fv"}],e._shader=y,e._texture=null,e.type=m.COMPLEX_MESH_MATERIAL,e}return o(t,e),u(t,[{key:"setTexture",value:function(e){return this._texture=e,this}},{key:"getTexture",value:function(){return this._texture}},{key:"_prepare",value:function(e){this._enableLight(e),this._texture&&this._enableTexture(),s(Object.getPrototypeOf(t.prototype),"_prepare",this).call(this,e)}},{key:"_enableLight",value:function(e){var t=e.scene,r=0;t.getLights().forEach(function(e){e.type===m.DIRECTIONAL_LIGHT&&r++}),this.define("directionLights",r),r>0&&(this._attributes.push({name:"normal"}),this._uniforms.push({name:"uDirectionLightColors",type:"3fv"},{name:"uDirectionLightPositions",type:"3fv"},{name:"uNormalMatrix",type:"mat3"}))}},{key:"_enableTexture",value:function(){this.define("texture"),this._attributes.push({name:"texture"},{name:"textureEnable"}),this._uniforms.push({name:"uTexture",type:"1i"})}},{key:"_shaderProgramBind",value:function(e){var t=e.gl,r=e.scene,n=e.camera,i=e.object,a={},o={};this._texture&&(this._texture.enable(t,0),a.uTexture=0);var u=r.getLights();u.length&&!function(){var e=[],t=[];if(u.forEach(function(r){if(r.type===m.AMBIENT_LIGHT)a.uAmbientLightColor=r.color;else if(r.type===m.DIRECTIONAL_LIGHT){e=e.concat(r.color);var n=d.vec3.create();d.vec3.scale(n,r.position,-1),t=t.concat(Array.prototype.slice.call(n))}}),e.length&&t.length){var r=d.mat3.create();d.mat3.fromMat4(r,i.worldMatrix),d.mat3.invert(r,r),d.mat3.transpose(r,r),a.uNormalMatrix=new Float32Array(r),o.normal=i.geometry.getBuffer("normal")}a.uDirectionLightColors=new Float32Array(e),a.uDirectionLightPositions=new Float32Array(t)}(),this._attributes.forEach(function(e){"normal"!==e.name&&(o[e.name]=i.geometry.getBuffer(e.name))}),a.uPosition=new Float32Array(i.worldMatrix),a.uCamera=new Float32Array(n.modelViewMatrix),a.uColorAlpha=this.opacity,this._shaderProgram.bind(t,a,o)}}]),t}(v.default);r.default=b,t.exports=r.default},{"../libConstants":35,"../shaders/complex.frag.glsl.js":58,"../shaders/complex.vert.glsl.js":59,"./Material":41,"gl-matrix":2}],41:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=e("./definitions"),u=n(o),s=e("../ShaderProgram"),l=n(s),c=e("../libConstants"),f=e("../Shader"),h=n(f),d={},p=function(){function e(){i(this,e),this._attributes=[],this._uniforms=[{name:"uColorAlpha",type:"1f"}],this._definitions=[],this._shader=null,this.opacity=1}return a(e,[{key:"enable",value:function(e){return this._shaderProgram||this._prepare(e),this._shaderProgram.enable(e.gl),this._shaderProgramBind(e),this}},{key:"disable",value:function(e){return this._shaderProgram&&this._shaderProgram.disable(e),this}},{key:"define",value:function(e,t){return u.default[e]&&this._definitions.push({type:u.default[e],value:t}),this}},{key:"typifyForRender",value:function(e,t){1===this.opacity?e[c.COMMON_RENDERER].addObject(t):e[c.TRANSPARENT_RENDERER].addObject(t)}},{key:"_getCachedProgramKey",value:function(){var e=this.constructor.name;return this._definitions.forEach(function(t){e+=":"+t.type+":"+(t.value||"")}),e}},{key:"_getCachedProgram",value:function(){return d[this._getCachedProgramKey()]}},{key:"_prepare",value:function(e){var t=this._getCachedProgram();return t&&e===t.glContext?void(this._shaderProgram=t.program):(this._shaderProgram=new l.default({vertex:new h.default("vertex",this._shader.vertex,this._definitions),fragment:new h.default("fragment",this._shader.fragment,this._definitions),uniforms:this._uniforms,attributes:this._attributes}),void(d[this._getCachedProgramKey()]={glContext:e,program:this._shaderProgram}))}},{key:"_shaderProgramBind",value:function(e){var t=e.gl,r=e.object,n={};this._attributes.forEach(function(e){n[e.name]=r.geometry.getBuffer(e.name)});var i={uColorAlpha:this.opacity};this._shaderProgram.bind(t,i,n)}}]),e}();r.default=p,t.exports=r.default},{"../Shader":24,"../ShaderProgram":26,"../libConstants":35,"./definitions":44}],42:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("../libConstants"),o=function(){function e(){n(this,e),this.smoothing=1,this._texture=null,this.type=a.MULTI_SPRITE_MATERIAL;
}return i(e,[{key:"setTexture",value:function(e){return this._texture=e,this}},{key:"getTexture",value:function(){return this._texture}},{key:"enable",value:function(e){var t=e.gl,r=e.shaderProgram;r.bind(t,{uSmoothing:this.smoothing}),this._texture&&this._texture.enable(t)}},{key:"disable",value:function(){}}]),e}();r.default=o,t.exports=r.default},{"../libConstants":35}],43:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("../libConstants"),o=function(){function e(){n(this,e),this.opacity=1,this.smoothing=0,this._texture=null,this.type=a.SPRITE_MATERIAL}return i(e,[{key:"setTexture",value:function(e){return this._texture=e,this}},{key:"getTexture",value:function(){return this._texture}},{key:"enable",value:function(e){var t=e.gl,r=e.object,n=e.shaderProgram,i=e.renderer,a=i.getSize();n.bind(t,{uColorAlpha:this.opacity,uSmoothing:this.smoothing,uHalfSize:[a[0]/2,a[1]/2],uOffset:r.offset,uScale:r.scale,uPosition:[r.worldMatrix[12],r.worldMatrix[13],r.worldMatrix[14]]}),this._texture&&this._texture.enable(t)}},{key:"disable",value:function(){}}]),e}();r.default=o,t.exports=r.default},{"../libConstants":35}],44:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={texture:"USE_TEXTURE",directionLights:"DIR_LIGHT_NUM"},t.exports=r.default},{}],45:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("gl-matrix"),o=function(){function e(t,r){n(this,e),this.min=t||a.vec3.create(),this.max=r||a.vec3.create()}return i(e,[{key:"containsPoint",value:function(e){return e[0]>this.min[0]&&e[0]<this.max[0]&&e[1]>this.min[1]&&e[1]<this.max[1]&&e[2]>this.min[2]&&e[2]<this.max[2]}},{key:"expandByPoint",value:function(e){return a.vec3.min(this.min,this.min,e),a.vec3.max(this.max,this.max,e),this}}]),e}();r.default=o,t.exports=r.default},{"gl-matrix":2}],46:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=e("gl-matrix"),u=e("./Plane"),s=n(u),l=function(){function e(t){i(this,e),this.planes=t,this.planes&&6===this.planes.length||(this.planes=[new s.default,new s.default,new s.default,new s.default,new s.default,new s.default]),this._v1=o.vec3.create(),this._v2=o.vec3.create()}return a(e,[{key:"setFromMatrix",value:function(e){var t=this.planes;return t[0].setComponents(e[3]-e[0],e[7]-e[4],e[11]-e[8],e[15]-e[12]).normalize(),t[1].setComponents(e[3]+e[0],e[7]+e[4],e[11]+e[8],e[15]+e[12]).normalize(),t[2].setComponents(e[3]+e[1],e[7]+e[5],e[11]+e[9],e[15]+e[13]).normalize(),t[3].setComponents(e[3]-e[1],e[7]-e[5],e[11]-e[9],e[15]-e[13]).normalize(),t[4].setComponents(e[3]-e[2],e[7]-e[6],e[11]-e[10],e[15]-e[14]).normalize(),t[5].setComponents(e[3]+e[2],e[7]+e[6],e[11]+e[10],e[15]+e[14]).normalize(),this}},{key:"intersectsBox",value:function(e){for(var t=this._v1,r=this._v2,n=this.planes,i=e.min,a=e.max,o=0;o<6;o++){var u=n[o],s=u.normal;t[0]=s[0]>0?i[0]:a[0],r[0]=s[0]>0?a[0]:i[0],t[1]=s[1]>0?i[1]:a[1],r[1]=s[1]>0?a[1]:i[1],t[2]=s[2]>0?i[2]:a[2],r[2]=s[2]>0?a[2]:i[2];var l=u.distanceToPoint(t),c=u.distanceToPoint(r);if(l<0&&c<0)return!1}return!0}}]),e}();r.default=l,t.exports=r.default},{"./Plane":49,"gl-matrix":2}],47:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("gl-matrix"),o=e("./Math.js"),u=function(){function e(t,r){n(this,e),this.start=t||a.vec3.create(),this.end=r||a.vec3.create()}return i(e,[{key:"closestPointToPointParameter",value:function(e,t){var r=a.vec3.create(),n=a.vec3.create();a.vec3.sub(r,e,this.start),a.vec3.sub(n,this.end,this.start);var i=a.vec3.dot(n,n),u=a.vec3.dot(n,r),s=u/i;return t&&(s=(0,o.clamp)(s,0,1)),s}},{key:"closestPointToPoint",value:function(e,t,r){var n=this.closestPointToPointParameter(e,t),i=r||a.vec3.create();return i=this.delta(i),a.vec3.scale(i,i,n),a.vec3.add(i,i,this.start),i}},{key:"delta",value:function(e){var t=e||a.vec3.create();return a.vec3.sub(t,this.end,this.start),t}}]),e}();r.default=u,t.exports=r.default},{"./Math.js":48,"gl-matrix":2}],48:[function(e,t,r){"use strict";function n(e,t,r){return e<t?t:e>r?r:e}function i(e){return e*Math.PI/180}Object.defineProperty(r,"__esModule",{value:!0}),r.clamp=n,r.degToRad=i},{}],49:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("gl-matrix"),o=function(){function e(t,r){n(this,e),this.normal=t||a.vec3.create(),this.constant=r||0}return i(e,[{key:"distanceToPoint",value:function(e){return a.vec3.dot(this.normal,e)+this.constant}},{key:"setComponents",value:function(e,t,r,n){return a.vec3.set(this.normal,e,t,r),this.constant=n,this}},{key:"normalize",value:function(){var e=1/a.vec3.len(this.normal);return a.vec3.scale(this.normal,this.normal,e),this.constant*=e,this}}]),e}();r.default=o,t.exports=r.default},{"gl-matrix":2}],50:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("gl-matrix"),o=function(){function e(t,r){n(this,e),this.origin=t||a.vec3.create(),this.direction=r||a.vec3.create()}return i(e,[{key:"clone",value:function(){return new e(a.vec3.clone(this.origin),a.vec3.clone(this.direction))}},{key:"at",value:function(e){var t=a.vec3.create();return a.vec3.scaleAndAdd(t,this.origin,this.direction,e),t}},{key:"intersectBox",value:function(e){var t=void 0,r=void 0,n=void 0,i=void 0,a=void 0,o=void 0,u=1/this.direction[0],s=1/this.direction[1],l=1/this.direction[2],c=this.origin;return u>=0?(t=(e.min[0]-c[0])*u,r=(e.max[0]-c[0])*u):(t=(e.max[0]-c[0])*u,r=(e.min[0]-c[0])*u),s>=0?(n=(e.min[1]-c[1])*s,i=(e.max[1]-c[1])*s):(n=(e.max[1]-c[1])*s,i=(e.min[1]-c[1])*s),t>i||n>r?null:((n>t||t!==t)&&(t=n),(i<r||r!==r)&&(r=i),l>=0?(a=(e.min[2]-c[2])*l,o=(e.max[2]-c[2])*l):(a=(e.max[2]-c[2])*l,o=(e.min[2]-c[2])*l),t>o||a>r?null:((a>t||t!==t)&&(t=a),(o<r||r!==r)&&(r=o),r<0?null:this.at(t>=0?t:r)))}},{key:"applyMatrix4",value:function(e){return a.vec3.add(this.direction,this.direction,this.origin),a.vec3.transformMat4(this.direction,this.direction,e),a.vec3.transformMat4(this.origin,this.origin,e),a.vec3.sub(this.direction,this.direction,this.origin),a.vec3.normalize(this.direction,this.direction),this}},{key:"intersectTriangle",value:function(e,t){var r=a.vec3.create(),n=a.vec3.create(),i=a.vec3.create();a.vec3.sub(r,e[1],e[0]),a.vec3.sub(n,e[2],e[0]),a.vec3.cross(i,r,n);var o=a.vec3.dot(this.direction,i),u=void 0;if(o>0){if(t)return null;u=1}else{if(!(o<0))return null;u=-1,o=-o}var s=a.vec3.create();a.vec3.sub(s,this.origin,e[0]);var l=a.vec3.create();a.vec3.cross(l,s,n);var c=u*a.vec3.dot(this.direction,l);if(c<0)return null;var f=a.vec3.create();a.vec3.cross(f,r,s);var h=u*a.vec3.dot(this.direction,f);if(h<0)return null;if(c+h>o)return null;var d=-u*a.vec3.dot(s,i);return d<0?null:this.at(d/o)}},{key:"distanceToPlane",value:function(e){var t=a.vec3.dot(e.normal,this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var r=-(a.vec3.dot(this.origin,e.normal)+e.constant)/t;return r>=0?r:null}},{key:"intersectPlane",value:function(e){var t=this.distanceToPlane(e);return null===t?null:this.at(t)}}]),e}();r.default=o,t.exports=r.default},{"gl-matrix":2}],51:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../RendererPlugin"),l=n(s),c=e("../libConstants"),f=function(e){function t(){i(this,t);var e=a(this,Object.getPrototypeOf(t).call(this));return e.type=c.COMMON_RENDERER,e}return o(t,e),u(t,[{key:"render",value:function(e){var t=e.gl;return t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.frontFace(t.CCW),t.cullFace(t.BACK),t.enable(t.CULL_FACE),t.disable(t.BLEND),e.renderer.sortObjects&&this._objects.sort(this._renderOrderSort),this._objects.forEach(function(t){return t.render(e)}),this._objects=[],this}},{key:"_renderOrderSort",value:function(e,t){return e.renderOrder-t.renderOrder}}]),t}(l.default);r.default=f,t.exports=r.default},{"../RendererPlugin":22,"../libConstants":35}],52:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../shaders/multiSprite.frag.glsl.js"),l=n(s),c=e("../shaders/multiSprite.vert.glsl.js"),f=n(c),h=e("../ShaderProgram"),d=n(h),p=e("../RendererPlugin"),v=n(p),m=e("../Shader"),y=n(m),b=e("../libConstants"),g=function(e){function t(){i(this,t);var e=a(this,Object.getPrototypeOf(t).call(this));return e._shaderProgram=new d.default({vertex:new y.default("vertex",f.default),fragment:new y.default("fragment",l.default),uniforms:[{name:"uPCamera",type:"mat4"},{name:"uHalfSize",type:"2f"},{name:"uTexture",type:"1i"},{name:"uSmoothing",type:"1f"}],attributes:[{name:"disposition"},{name:"texture"},{name:"position"},{name:"colorAlpha"},{name:"scale"},{name:"offset"}]}),e.type=b.MULTI_SPRITE_RENDERER,e}return o(t,e),u(t,[{key:"render",value:function(e){var t=e.gl,r=e.camera,n=e.renderer,i=n.getSize();return e.shaderProgram=this._shaderProgram,t.disable(t.DEPTH_TEST),t.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),this._shaderProgram.enable(t).bind(t,{uPCamera:new Float32Array(r.modelViewMatrix),uHalfSize:[i[0]/2,i[1]/2],uTexture:0}),t.activeTexture(t.TEXTURE0),this._objects.forEach(function(t){return t.render(e)}),this._objects=[],this._shaderProgram.disable(t),this}}]),t}(v.default);r.default=g,t.exports=r.default},{"../RendererPlugin":22,"../Shader":24,"../ShaderProgram":26,"../libConstants":35,"../shaders/multiSprite.frag.glsl.js":60,"../shaders/multiSprite.vert.glsl.js":61}],53:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../RendererPlugin"),l=n(s),c=e("../libConstants"),f=function(e){function t(){i(this,t);var e=a(this,Object.getPrototypeOf(t).call(this));return e.type=c.OBJECT_3D_RENDERER,e}return o(t,e),u(t,[{key:"render",value:function(e){return this._objects.forEach(function(t){return t.render(e)}),this._objects=[],this}}]),t}(l.default);r.default=f,t.exports=r.default},{"../RendererPlugin":22,"../libConstants":35}],54:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../shaders/sprite.frag.glsl.js"),l=n(s),c=e("../shaders/sprite.vert.glsl.js"),f=n(c),h=e("../ShaderProgram"),d=n(h),p=e("../RendererPlugin"),v=n(p),m=e("../Geometry"),y=n(m),b=e("../Shader"),g=n(b),_=e("../GeometryBuffer"),P=n(_),M=e("../libConstants"),E=function(e){function t(){i(this,t);var e=a(this,Object.getPrototypeOf(t).call(this));return e._geometry=new y.default,e._geometry.setBuffer("position",new P.default(new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]))).setBuffer("texture",new P.default(new Float32Array([0,0,1,0,1,1,0,1]),{itemSize:2})).setBuffer("index",new P.default(new Uint16Array([1,2,0,3,0,2]),{itemSize:1})),e._geometry.getBuffer("index").type=P.default.ElementArrayBuffer,e._shaderProgram=new d.default({vertex:new g.default("vertex",f.default),fragment:new g.default("fragment",l.default),uniforms:[{name:"uPCamera",type:"mat4"},{name:"uPosition",type:"3f"},{name:"uColorAlpha",type:"1f"},{name:"uScale",type:"2f"},{name:"uTexture",type:"1i"},{name:"uHalfSize",type:"2f"},{name:"uOffset",type:"2f"},{name:"uSmoothing",type:"1f"}],attributes:[{name:"position"},{name:"texture"},{name:"index",index:!0}]}),e.type=M.SPRITE_RENDERER,e}return o(t,e),u(t,[{key:"render",value:function(e){var t=e.gl,r=e.camera;return e.shaderProgram=this._shaderProgram,t.disable(t.DEPTH_TEST),t.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),this._shaderProgram.enable(t).bind(t,{uPCamera:new Float32Array(r.modelViewMatrix),uTexture:0},{position:this._geometry.getBuffer("position"),texture:this._geometry.getBuffer("texture"),index:this._geometry.getBuffer("index")}),t.activeTexture(t.TEXTURE0),this._objects.forEach(function(t){return t.render(e)}),this._objects=[],this._shaderProgram.disable(t),this}}]),t}(v.default);r.default=E,t.exports=r.default},{"../Geometry":14,"../GeometryBuffer":15,"../RendererPlugin":22,"../Shader":24,"../ShaderProgram":26,"../libConstants":35,"../shaders/sprite.frag.glsl.js":62,"../shaders/sprite.vert.glsl.js":63}],55:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../RendererPlugin"),l=n(s),c=e("../libConstants"),f=function(e){function t(){i(this,t);var e=a(this,Object.getPrototypeOf(t).call(this));return e.type=c.TRANSPARENT_RENDERER,e}return o(t,e),u(t,[{key:"render",value:function(e){var t=e.gl;return t.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),e.renderer.sortObjects&&this._sortObjects(e),this._objects.forEach(function(t){return t.render(e)}),this._objects=[],this}},{key:"_sortObjects",value:function(e){var t=e.camera,r=this._reversePainterSortStable.bind(this,t);this._objects.sort(r)}},{key:"_reversePainterSortStable",value:function(e,t,r){if(t.renderOrder!==r.renderOrder)return t.renderOrder-r.renderOrder;var n=e.project(t.getWorldPosition())[2],i=e.project(r.getWorldPosition())[2];return i-n}}]),t}(l.default);r.default=f,t.exports=r.default},{"../RendererPlugin":22,"../libConstants":35}],56:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default="\nprecision mediump float;\n\nuniform float uColorAlpha;\nvarying vec3 vColor;\n\nvoid main(void) {\n    gl_FragColor = vec4(vColor.rgb, uColorAlpha);\n}\n",t.exports=r.default},{}],57:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default="\nattribute vec3 position;\n\nuniform mat4 uPosition;\nuniform mat4 uCamera;\nuniform vec3 uColor;\nuniform vec3 uEmissive;\n\nvarying vec3 vColor;\n\nvoid main(void) {\n    vColor = uColor;\n\n    gl_Position = uCamera * uPosition * vec4(position, 1.0);\n}\n",t.exports=r.default},{}],58:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default="\nprecision mediump float;\n\n#ifdef USE_TEXTURE\n    uniform sampler2D uTexture;\n    varying vec2 vTextureCoord;\n    varying float vTextureEnable;\n#endif\n\nuniform float uColorAlpha;\nvarying vec3 vLightWeighting;\nvarying vec3 vColor;\nvarying vec3 vEmissive;\n\nvoid main(void) {\n    vec4 color = vec4(vColor.rgb, uColorAlpha);\n\n    #ifdef USE_TEXTURE\n        if (vTextureEnable > 0.5) {\n            vec4 textureColor = texture2D(uTexture, vec2(vTextureCoord.s, vTextureCoord.t));\n            color = vec4(textureColor.rgb * color.rgb, color.a);\n        }\n    #endif\n\n    gl_FragColor = vec4(color.rgb * vLightWeighting + vEmissive, color.a);\n}\n",t.exports=r.default},{}],59:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default="\nattribute vec3 position;\nattribute vec3 color;\nattribute vec3 emissive;\n\n#ifdef USE_TEXTURE\n    attribute vec2 texture;\n    attribute float textureEnable;\n    varying vec2 vTextureCoord;\n    varying float vTextureEnable;\n#endif\n\n#if DIR_LIGHT_NUM > 0\n    attribute vec3 normal;\n    uniform vec3 uDirectionLightColors[DIR_LIGHT_NUM];\n    uniform vec3 uDirectionLightPositions[DIR_LIGHT_NUM];\n    uniform mat3 uNormalMatrix;\n#endif\n\nuniform mat4 uPosition;\nuniform vec3 uAmbientLightColor;\nuniform mat4 uCamera;\n\nvarying vec3 vColor;\nvarying vec3 vEmissive;\nvarying vec3 vLightWeighting;\n\nvoid main(void) {\n    vColor = color;\n    vEmissive = emissive;\n\n    #ifdef USE_TEXTURE\n        vTextureCoord = texture;\n        vTextureEnable = textureEnable;\n    #endif\n\n    vec3 vLightTemp = vec3(0.0);\n\n    #if DIR_LIGHT_NUM > 0\n        vec3 transformedNormal = uNormalMatrix * normal;\n\n        for(int i = 0; i < DIR_LIGHT_NUM; i++) {\n            float dotProduct = dot(transformedNormal, uDirectionLightPositions[i]);\n            vec3 directionalLightWeighting = vec3(max(dotProduct, 0.0));\n            vLightTemp += uDirectionLightColors[i] * directionalLightWeighting;\n        }\n    #endif\n\n    vLightWeighting = uAmbientLightColor + vLightTemp;\n\n    gl_Position = uCamera * uPosition * vec4(position, 1.0);\n}\n",t.exports=r.default},{}],60:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default="\nprecision mediump float;\n\nuniform sampler2D uTexture;\n\nvarying vec2 vTextureCoord;\nvarying float vColorAlpha;\n\nvoid main(void) {\n    vec4 textureColor = texture2D(uTexture, vec2(vTextureCoord.s, vTextureCoord.t));\n\n    gl_FragColor = textureColor * vColorAlpha;\n}\n",t.exports=r.default},{}],61:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default="\nattribute vec2 disposition;\nattribute vec2 texture;\n\nattribute vec3 position;\nattribute vec2 scale;\nattribute vec2 offset;\nattribute float colorAlpha;\n\nuniform float uSmoothing;\nuniform mat4 uPCamera;\nuniform vec2 uHalfSize;\n\nvarying vec2 vTextureCoord;\nvarying float vColorAlpha;\n\nvoid main(void) {\n    vTextureCoord = texture;\n    vColorAlpha = colorAlpha;\n\n    vec2 alignedPosition = disposition * scale;\n    alignedPosition += offset;\n    alignedPosition /= uHalfSize;\n\n    vec4 ndcPosition = uPCamera * vec4(position, 1.0);\n    ndcPosition.xyz = ndcPosition.xyz / ndcPosition.w;\n    ndcPosition.w = 1.0;\n    ndcPosition.xy += alignedPosition.xy;\n\n    vec2 roundedPosition = floor((ndcPosition.xy + 1.0) * uHalfSize.xy + 0.5) / uHalfSize.xy - 1.0;\n    vec2 roundingDelta = roundedPosition - ndcPosition.xy;\n\n    if (vColorAlpha == 0.0) {\n        ndcPosition.xy = vec2(-2.0, -2.0);\n    } else {\n        ndcPosition.xy = ndcPosition.xy + roundingDelta * uSmoothing;\n    }\n\n    gl_Position = ndcPosition;\n}\n",t.exports=r.default},{}],62:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default="\nprecision mediump float;\n\nuniform float uColorAlpha;\nuniform sampler2D uTexture;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n    vec4 textureColor = texture2D(uTexture, vec2(vTextureCoord.s, vTextureCoord.t));\n\n    gl_FragColor = textureColor * uColorAlpha;\n}\n",t.exports=r.default},{}],63:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default="\nattribute vec2 position;\nattribute vec2 texture;\n\nuniform vec3 uPosition;\nuniform mat4 uPCamera;\nuniform vec2 uScale;\nuniform vec2 uHalfSize;\nuniform vec2 uOffset;\nuniform float uSmoothing;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n    vTextureCoord = texture;\n\n    vec2 alignedPosition = position * uScale;\n    alignedPosition += uOffset;\n    alignedPosition /= uHalfSize;\n\n    vec4 ndcPosition = uPCamera * vec4(uPosition, 1.0);\n    ndcPosition.xyz = ndcPosition.xyz / ndcPosition.w;\n    ndcPosition.w = 1.0;\n    ndcPosition.xy += alignedPosition.xy;\n\n    vec2 roundedPosition = floor((ndcPosition.xy + 1.0) * uHalfSize.xy + 0.5) / uHalfSize.xy - 1.0;\n    vec2 roundingDelta = roundedPosition - ndcPosition.xy;\n\n    ndcPosition.xy = ndcPosition.xy + roundingDelta * uSmoothing;\n\n    gl_Position = ndcPosition;\n}\n",t.exports=r.default},{}]},{},[34])(34)});
//# sourceMappingURL=dist/2gl.js.map