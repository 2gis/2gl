!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.dgl=t()}}(function(){return function t(e,r,n){function i(a,u){if(!r[a]){if(!e[a]){var s="function"==typeof require&&require;if(!u&&s)return s(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[a]={exports:{}};e[a][0].call(l.exports,function(t){var r=e[a][1][t];return i(r?r:t)},l,l.exports,t,e,r,n)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(t,e,r){(function(t){function e(t,e){for(var r=0,n=t.length-1;n>=0;n--){var i=t[n];"."===i?t.splice(n,1):".."===i?(t.splice(n,1),r++):r&&(t.splice(n,1),r--)}if(e)for(;r--;r)t.unshift("..");return t}function n(t,e){if(t.filter)return t.filter(e);for(var r=[],n=0;n<t.length;n++)e(t[n],n,t)&&r.push(t[n]);return r}var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(t){return i.exec(t).slice(1)};r.resolve=function(){for(var r="",i=!1,o=arguments.length-1;o>=-1&&!i;o--){var a=o>=0?arguments[o]:t.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(r=a+"/"+r,i="/"===a.charAt(0))}return r=e(n(r.split("/"),function(t){return!!t}),!i).join("/"),(i?"/":"")+r||"."},r.normalize=function(t){var i=r.isAbsolute(t),o="/"===a(t,-1);return t=e(n(t.split("/"),function(t){return!!t}),!i).join("/"),t||i||(t="."),t&&o&&(t+="/"),(i?"/":"")+t},r.isAbsolute=function(t){return"/"===t.charAt(0)},r.join=function(){var t=Array.prototype.slice.call(arguments,0);return r.normalize(n(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},r.relative=function(t,e){function n(t){for(var e=0;e<t.length&&""===t[e];e++);for(var r=t.length-1;r>=0&&""===t[r];r--);return e>r?[]:t.slice(e,r-e+1)}t=r.resolve(t).substr(1),e=r.resolve(e).substr(1);for(var i=n(t.split("/")),o=n(e.split("/")),a=Math.min(i.length,o.length),u=a,s=0;a>s;s++)if(i[s]!==o[s]){u=s;break}for(var c=[],s=u;s<i.length;s++)c.push("..");return c=c.concat(o.slice(u)),c.join("/")},r.sep="/",r.delimiter=":",r.dirname=function(t){var e=o(t),r=e[0],n=e[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},r.basename=function(t,e){var r=o(t)[2];return e&&r.substr(-1*e.length)===e&&(r=r.substr(0,r.length-e.length)),r},r.extname=function(t){return o(t)[3]};var a="b"==="ab".substr(-1)?function(t,e,r){return t.substr(e,r)}:function(t,e,r){return 0>e&&(e=t.length+e),t.substr(e,r)}}).call(this,t("_process"))},{_process:2}],2:[function(t,e,r){function n(){l=!1,u.length?c=u.concat(c):f=-1,c.length&&i()}function i(){if(!l){var t=setTimeout(n);l=!0;for(var e=c.length;e;){for(u=c,c=[];++f<e;)u&&u[f].run();f=-1,e=c.length}u=null,l=!1,clearTimeout(t)}}function o(t,e){this.fun=t,this.array=e}function a(){}var u,s=e.exports={},c=[],l=!1,f=-1;s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];c.push(new o(t,e)),1!==c.length||l||setTimeout(i,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=a,s.addListener=a,s.once=a,s.off=a,s.removeListener=a,s.removeAllListeners=a,s.emit=a,s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],3:[function(t,e,r){r.glMatrix=t("./gl-matrix/common.js"),r.mat2=t("./gl-matrix/mat2.js"),r.mat2d=t("./gl-matrix/mat2d.js"),r.mat3=t("./gl-matrix/mat3.js"),r.mat4=t("./gl-matrix/mat4.js"),r.quat=t("./gl-matrix/quat.js"),r.vec2=t("./gl-matrix/vec2.js"),r.vec3=t("./gl-matrix/vec3.js"),r.vec4=t("./gl-matrix/vec4.js")},{"./gl-matrix/common.js":4,"./gl-matrix/mat2.js":5,"./gl-matrix/mat2d.js":6,"./gl-matrix/mat3.js":7,"./gl-matrix/mat4.js":8,"./gl-matrix/quat.js":9,"./gl-matrix/vec2.js":10,"./gl-matrix/vec3.js":11,"./gl-matrix/vec4.js":12}],4:[function(t,e,r){var n={};n.EPSILON=1e-6,n.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,n.RANDOM=Math.random,n.setMatrixArrayType=function(t){GLMAT_ARRAY_TYPE=t};var i=Math.PI/180;n.toRadian=function(t){return t*i},e.exports=n},{}],5:[function(t,e,r){var n=t("./common.js"),i={};i.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},i.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},i.transpose=function(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},i.invert=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r*o-i*n;return a?(a=1/a,t[0]=o*a,t[1]=-n*a,t[2]=-i*a,t[3]=r*a,t):null},i.adjoint=function(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},i.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},i.multiply=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],u=r[0],s=r[1],c=r[2],l=r[3];return t[0]=n*u+o*s,t[1]=i*u+a*s,t[2]=n*c+o*l,t[3]=i*c+a*l,t},i.mul=i.multiply,i.rotate=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=n*s+o*u,t[1]=i*s+a*u,t[2]=n*-u+o*s,t[3]=i*-u+a*s,t},i.scale=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],u=r[0],s=r[1];return t[0]=n*u,t[1]=i*u,t[2]=o*s,t[3]=a*s,t},i.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},i.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},i.LDU=function(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]},e.exports=i},{"./common.js":4}],6:[function(t,e,r){var n=t("./common.js"),i={};i.create=function(){var t=new n.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},i.clone=function(t){var e=new n.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},i.invert=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=r*o-n*i;return s?(s=1/s,t[0]=o*s,t[1]=-n*s,t[2]=-i*s,t[3]=r*s,t[4]=(i*u-o*a)*s,t[5]=(n*a-r*u)*s,t):null},i.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},i.multiply=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=r[0],l=r[1],f=r[2],h=r[3],v=r[4],p=r[5];return t[0]=n*c+o*l,t[1]=i*c+a*l,t[2]=n*f+o*h,t[3]=i*f+a*h,t[4]=n*v+o*p+u,t[5]=i*v+a*p+s,t},i.mul=i.multiply,i.rotate=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=Math.sin(r),l=Math.cos(r);return t[0]=n*l+o*c,t[1]=i*l+a*c,t[2]=n*-c+o*l,t[3]=i*-c+a*l,t[4]=u,t[5]=s,t},i.scale=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=r[0],l=r[1];return t[0]=n*c,t[1]=i*c,t[2]=o*l,t[3]=a*l,t[4]=u,t[5]=s,t},i.translate=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=r[0],l=r[1];return t[0]=n,t[1]=i,t[2]=o,t[3]=a,t[4]=n*c+o*l+u,t[5]=i*c+a*l+s,t},i.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t[4]=0,t[5]=0,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},i.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},i.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},e.exports=i},{"./common.js":4}],7:[function(t,e,r){var n=t("./common.js"),i={};i.create=function(){var t=new n.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},i.clone=function(t){var e=new n.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},i.invert=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],c=e[7],l=e[8],f=l*a-u*c,h=-l*o+u*s,v=c*o-a*s,p=r*f+n*h+i*v;return p?(p=1/p,t[0]=f*p,t[1]=(-l*n+i*c)*p,t[2]=(u*n-i*a)*p,t[3]=h*p,t[4]=(l*r-i*s)*p,t[5]=(-u*r+i*o)*p,t[6]=v*p,t[7]=(-c*r+n*s)*p,t[8]=(a*r-n*o)*p,t):null},i.adjoint=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],c=e[7],l=e[8];return t[0]=a*l-u*c,t[1]=i*c-n*l,t[2]=n*u-i*a,t[3]=u*s-o*l,t[4]=r*l-i*s,t[5]=i*o-r*u,t[6]=o*c-a*s,t[7]=n*s-r*c,t[8]=r*a-n*o,t},i.determinant=function(t){var e=t[0],r=t[1],n=t[2],i=t[3],o=t[4],a=t[5],u=t[6],s=t[7],c=t[8];return e*(c*o-a*s)+r*(-c*i+a*u)+n*(s*i-o*u)},i.multiply=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=e[6],l=e[7],f=e[8],h=r[0],v=r[1],p=r[2],d=r[3],m=r[4],g=r[5],y=r[6],b=r[7],_=r[8];return t[0]=h*n+v*a+p*c,t[1]=h*i+v*u+p*l,t[2]=h*o+v*s+p*f,t[3]=d*n+m*a+g*c,t[4]=d*i+m*u+g*l,t[5]=d*o+m*s+g*f,t[6]=y*n+b*a+_*c,t[7]=y*i+b*u+_*l,t[8]=y*o+b*s+_*f,t},i.mul=i.multiply,i.translate=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=e[6],l=e[7],f=e[8],h=r[0],v=r[1];return t[0]=n,t[1]=i,t[2]=o,t[3]=a,t[4]=u,t[5]=s,t[6]=h*n+v*a+c,t[7]=h*i+v*u+l,t[8]=h*o+v*s+f,t},i.rotate=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=e[6],l=e[7],f=e[8],h=Math.sin(r),v=Math.cos(r);return t[0]=v*n+h*a,t[1]=v*i+h*u,t[2]=v*o+h*s,t[3]=v*a-h*n,t[4]=v*u-h*i,t[5]=v*s-h*o,t[6]=c,t[7]=l,t[8]=f,t},i.scale=function(t,e,r){var n=r[0],i=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},i.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},i.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},i.fromQuat=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r+r,u=n+n,s=i+i,c=r*a,l=n*a,f=n*u,h=i*a,v=i*u,p=i*s,d=o*a,m=o*u,g=o*s;return t[0]=1-f-p,t[3]=l-g,t[6]=h+m,t[1]=l+g,t[4]=1-c-p,t[7]=v-d,t[2]=h-m,t[5]=v+d,t[8]=1-c-f,t},i.normalFromMat4=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],c=e[7],l=e[8],f=e[9],h=e[10],v=e[11],p=e[12],d=e[13],m=e[14],g=e[15],y=r*u-n*a,b=r*s-i*a,_=r*c-o*a,M=n*s-i*u,x=n*c-o*u,P=i*c-o*s,w=l*d-f*p,O=l*m-h*p,E=l*g-v*p,A=f*m-h*d,j=f*g-v*d,T=h*g-v*m,R=y*T-b*j+_*A+M*E-x*O+P*w;return R?(R=1/R,t[0]=(u*T-s*j+c*A)*R,t[1]=(s*E-a*T-c*O)*R,t[2]=(a*j-u*E+c*w)*R,t[3]=(i*j-n*T-o*A)*R,t[4]=(r*T-i*E+o*O)*R,t[5]=(n*E-r*j-o*w)*R,t[6]=(d*P-m*x+g*M)*R,t[7]=(m*_-p*P-g*b)*R,t[8]=(p*x-d*_+g*y)*R,t):null},i.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},e.exports=i},{"./common.js":4}],8:[function(t,e,r){var n=t("./common.js"),i={};i.create=function(){var t=new n.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.clone=function(t){var e=new n.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],i=e[3],o=e[6],a=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},i.invert=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],c=e[7],l=e[8],f=e[9],h=e[10],v=e[11],p=e[12],d=e[13],m=e[14],g=e[15],y=r*u-n*a,b=r*s-i*a,_=r*c-o*a,M=n*s-i*u,x=n*c-o*u,P=i*c-o*s,w=l*d-f*p,O=l*m-h*p,E=l*g-v*p,A=f*m-h*d,j=f*g-v*d,T=h*g-v*m,R=y*T-b*j+_*A+M*E-x*O+P*w;return R?(R=1/R,t[0]=(u*T-s*j+c*A)*R,t[1]=(i*j-n*T-o*A)*R,t[2]=(d*P-m*x+g*M)*R,t[3]=(h*x-f*P-v*M)*R,t[4]=(s*E-a*T-c*O)*R,t[5]=(r*T-i*E+o*O)*R,t[6]=(m*_-p*P-g*b)*R,t[7]=(l*P-h*_+v*b)*R,t[8]=(a*j-u*E+c*w)*R,t[9]=(n*E-r*j-o*w)*R,t[10]=(p*x-d*_+g*y)*R,t[11]=(f*_-l*x-v*y)*R,t[12]=(u*O-a*A-s*w)*R,t[13]=(r*A-n*O+i*w)*R,t[14]=(d*b-p*M-m*y)*R,t[15]=(l*M-f*b+h*y)*R,t):null},i.adjoint=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],c=e[7],l=e[8],f=e[9],h=e[10],v=e[11],p=e[12],d=e[13],m=e[14],g=e[15];return t[0]=u*(h*g-v*m)-f*(s*g-c*m)+d*(s*v-c*h),t[1]=-(n*(h*g-v*m)-f*(i*g-o*m)+d*(i*v-o*h)),t[2]=n*(s*g-c*m)-u*(i*g-o*m)+d*(i*c-o*s),t[3]=-(n*(s*v-c*h)-u*(i*v-o*h)+f*(i*c-o*s)),t[4]=-(a*(h*g-v*m)-l*(s*g-c*m)+p*(s*v-c*h)),t[5]=r*(h*g-v*m)-l*(i*g-o*m)+p*(i*v-o*h),t[6]=-(r*(s*g-c*m)-a*(i*g-o*m)+p*(i*c-o*s)),t[7]=r*(s*v-c*h)-a*(i*v-o*h)+l*(i*c-o*s),t[8]=a*(f*g-v*d)-l*(u*g-c*d)+p*(u*v-c*f),t[9]=-(r*(f*g-v*d)-l*(n*g-o*d)+p*(n*v-o*f)),t[10]=r*(u*g-c*d)-a*(n*g-o*d)+p*(n*c-o*u),t[11]=-(r*(u*v-c*f)-a*(n*v-o*f)+l*(n*c-o*u)),t[12]=-(a*(f*m-h*d)-l*(u*m-s*d)+p*(u*h-s*f)),t[13]=r*(f*m-h*d)-l*(n*m-i*d)+p*(n*h-i*f),t[14]=-(r*(u*m-s*d)-a*(n*m-i*d)+p*(n*s-i*u)),t[15]=r*(u*h-s*f)-a*(n*h-i*f)+l*(n*s-i*u),t},i.determinant=function(t){var e=t[0],r=t[1],n=t[2],i=t[3],o=t[4],a=t[5],u=t[6],s=t[7],c=t[8],l=t[9],f=t[10],h=t[11],v=t[12],p=t[13],d=t[14],m=t[15],g=e*a-r*o,y=e*u-n*o,b=e*s-i*o,_=r*u-n*a,M=r*s-i*a,x=n*s-i*u,P=c*p-l*v,w=c*d-f*v,O=c*m-h*v,E=l*d-f*p,A=l*m-h*p,j=f*m-h*d;return g*j-y*A+b*E+_*O-M*w+x*P},i.multiply=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=e[6],l=e[7],f=e[8],h=e[9],v=e[10],p=e[11],d=e[12],m=e[13],g=e[14],y=e[15],b=r[0],_=r[1],M=r[2],x=r[3];return t[0]=b*n+_*u+M*f+x*d,t[1]=b*i+_*s+M*h+x*m,t[2]=b*o+_*c+M*v+x*g,t[3]=b*a+_*l+M*p+x*y,b=r[4],_=r[5],M=r[6],x=r[7],t[4]=b*n+_*u+M*f+x*d,t[5]=b*i+_*s+M*h+x*m,t[6]=b*o+_*c+M*v+x*g,t[7]=b*a+_*l+M*p+x*y,b=r[8],_=r[9],M=r[10],x=r[11],t[8]=b*n+_*u+M*f+x*d,t[9]=b*i+_*s+M*h+x*m,t[10]=b*o+_*c+M*v+x*g,t[11]=b*a+_*l+M*p+x*y,b=r[12],_=r[13],M=r[14],x=r[15],t[12]=b*n+_*u+M*f+x*d,t[13]=b*i+_*s+M*h+x*m,t[14]=b*o+_*c+M*v+x*g,t[15]=b*a+_*l+M*p+x*y,t},i.mul=i.multiply,i.translate=function(t,e,r){var n,i,o,a,u,s,c,l,f,h,v,p,d=r[0],m=r[1],g=r[2];return e===t?(t[12]=e[0]*d+e[4]*m+e[8]*g+e[12],t[13]=e[1]*d+e[5]*m+e[9]*g+e[13],t[14]=e[2]*d+e[6]*m+e[10]*g+e[14],t[15]=e[3]*d+e[7]*m+e[11]*g+e[15]):(n=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=e[6],l=e[7],f=e[8],h=e[9],v=e[10],p=e[11],t[0]=n,t[1]=i,t[2]=o,t[3]=a,t[4]=u,t[5]=s,t[6]=c,t[7]=l,t[8]=f,t[9]=h,t[10]=v,t[11]=p,t[12]=n*d+u*m+f*g+e[12],t[13]=i*d+s*m+h*g+e[13],t[14]=o*d+c*m+v*g+e[14],t[15]=a*d+l*m+p*g+e[15]),t},i.scale=function(t,e,r){var n=r[0],i=r[1],o=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.rotate=function(t,e,r,i){var o,a,u,s,c,l,f,h,v,p,d,m,g,y,b,_,M,x,P,w,O,E,A,j,T=i[0],R=i[1],C=i[2],L=Math.sqrt(T*T+R*R+C*C);return Math.abs(L)<n.EPSILON?null:(L=1/L,T*=L,R*=L,C*=L,o=Math.sin(r),a=Math.cos(r),u=1-a,s=e[0],c=e[1],l=e[2],f=e[3],h=e[4],v=e[5],p=e[6],d=e[7],m=e[8],g=e[9],y=e[10],b=e[11],_=T*T*u+a,M=R*T*u+C*o,x=C*T*u-R*o,P=T*R*u-C*o,w=R*R*u+a,O=C*R*u+T*o,E=T*C*u+R*o,A=R*C*u-T*o,j=C*C*u+a,t[0]=s*_+h*M+m*x,t[1]=c*_+v*M+g*x,t[2]=l*_+p*M+y*x,t[3]=f*_+d*M+b*x,t[4]=s*P+h*w+m*O,t[5]=c*P+v*w+g*O,t[6]=l*P+p*w+y*O,t[7]=f*P+d*w+b*O,t[8]=s*E+h*A+m*j,t[9]=c*E+v*A+g*j,t[10]=l*E+p*A+y*j,t[11]=f*E+d*A+b*j,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},i.rotateX=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[4],a=e[5],u=e[6],s=e[7],c=e[8],l=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*n,t[5]=a*i+l*n,t[6]=u*i+f*n,t[7]=s*i+h*n,t[8]=c*i-o*n,t[9]=l*i-a*n,t[10]=f*i-u*n,t[11]=h*i-s*n,t},i.rotateY=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[0],a=e[1],u=e[2],s=e[3],c=e[8],l=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*n,t[1]=a*i-l*n,t[2]=u*i-f*n,t[3]=s*i-h*n,t[8]=o*n+c*i,t[9]=a*n+l*i,t[10]=u*n+f*i,t[11]=s*n+h*i,t},i.rotateZ=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[0],a=e[1],u=e[2],s=e[3],c=e[4],l=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*n,t[1]=a*i+l*n,t[2]=u*i+f*n,t[3]=s*i+h*n,t[4]=c*i-o*n,t[5]=l*i-a*n,t[6]=f*i-u*n,t[7]=h*i-s*n,t},i.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromRotation=function(t,e,r){var i,o,a,u=r[0],s=r[1],c=r[2],l=Math.sqrt(u*u+s*s+c*c);return Math.abs(l)<n.EPSILON?null:(l=1/l,u*=l,s*=l,c*=l,i=Math.sin(e),o=Math.cos(e),a=1-o,t[0]=u*u*a+o,t[1]=s*u*a+c*i,t[2]=c*u*a-s*i,t[3]=0,t[4]=u*s*a-c*i,t[5]=s*s*a+o,t[6]=c*s*a+u*i,t[7]=0,t[8]=u*c*a+s*i,t[9]=s*c*a-u*i,t[10]=c*c*a+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},i.fromXRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromYRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromZRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromRotationTranslation=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],u=n+n,s=i+i,c=o+o,l=n*u,f=n*s,h=n*c,v=i*s,p=i*c,d=o*c,m=a*u,g=a*s,y=a*c;return t[0]=1-(v+d),t[1]=f+y,t[2]=h-g,t[3]=0,t[4]=f-y,t[5]=1-(l+d),t[6]=p+m,t[7]=0,t[8]=h+g,t[9]=p-m,t[10]=1-(l+v),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},i.fromRotationTranslationScale=function(t,e,r,n){var i=e[0],o=e[1],a=e[2],u=e[3],s=i+i,c=o+o,l=a+a,f=i*s,h=i*c,v=i*l,p=o*c,d=o*l,m=a*l,g=u*s,y=u*c,b=u*l,_=n[0],M=n[1],x=n[2];return t[0]=(1-(p+m))*_,t[1]=(h+b)*_,t[2]=(v-y)*_,t[3]=0,t[4]=(h-b)*M,t[5]=(1-(f+m))*M,t[6]=(d+g)*M,t[7]=0,t[8]=(v+y)*x,t[9]=(d-g)*x,t[10]=(1-(f+p))*x,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},i.fromRotationTranslationScaleOrigin=function(t,e,r,n,i){var o=e[0],a=e[1],u=e[2],s=e[3],c=o+o,l=a+a,f=u+u,h=o*c,v=o*l,p=o*f,d=a*l,m=a*f,g=u*f,y=s*c,b=s*l,_=s*f,M=n[0],x=n[1],P=n[2],w=i[0],O=i[1],E=i[2];return t[0]=(1-(d+g))*M,t[1]=(v+_)*M,t[2]=(p-b)*M,t[3]=0,t[4]=(v-_)*x,t[5]=(1-(h+g))*x,t[6]=(m+y)*x,t[7]=0,t[8]=(p+b)*P,t[9]=(m-y)*P,t[10]=(1-(h+d))*P,t[11]=0,t[12]=r[0]+w-(t[0]*w+t[4]*O+t[8]*E),t[13]=r[1]+O-(t[1]*w+t[5]*O+t[9]*E),t[14]=r[2]+E-(t[2]*w+t[6]*O+t[10]*E),t[15]=1,t},i.fromQuat=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r+r,u=n+n,s=i+i,c=r*a,l=n*a,f=n*u,h=i*a,v=i*u,p=i*s,d=o*a,m=o*u,g=o*s;return t[0]=1-f-p,t[1]=l+g,t[2]=h-m,t[3]=0,t[4]=l-g,t[5]=1-c-p,t[6]=v+d,t[7]=0,t[8]=h+m,t[9]=v-d,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.frustum=function(t,e,r,n,i,o,a){var u=1/(r-e),s=1/(i-n),c=1/(o-a);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*s,t[6]=0,t[7]=0,t[8]=(r+e)*u,t[9]=(i+n)*s,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t},i.perspective=function(t,e,r,n,i){var o=1/Math.tan(e/2),a=1/(n-i);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+n)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*n*a,t[15]=0,t},i.perspectiveFromFieldOfView=function(t,e,r,n){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),s=2/(a+u),c=2/(i+o);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-((a-u)*s*.5),t[9]=(i-o)*c*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t},i.ortho=function(t,e,r,n,i,o,a){var u=1/(e-r),s=1/(n-i),c=1/(o-a);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*u,t[13]=(i+n)*s,t[14]=(a+o)*c,t[15]=1,t},i.lookAt=function(t,e,r,o){var a,u,s,c,l,f,h,v,p,d,m=e[0],g=e[1],y=e[2],b=o[0],_=o[1],M=o[2],x=r[0],P=r[1],w=r[2];return Math.abs(m-x)<n.EPSILON&&Math.abs(g-P)<n.EPSILON&&Math.abs(y-w)<n.EPSILON?i.identity(t):(h=m-x,v=g-P,p=y-w,d=1/Math.sqrt(h*h+v*v+p*p),h*=d,v*=d,p*=d,a=_*p-M*v,u=M*h-b*p,s=b*v-_*h,d=Math.sqrt(a*a+u*u+s*s),d?(d=1/d,a*=d,u*=d,s*=d):(a=0,u=0,s=0),c=v*s-p*u,l=p*a-h*s,f=h*u-v*a,d=Math.sqrt(c*c+l*l+f*f),d?(d=1/d,c*=d,l*=d,f*=d):(c=0,l=0,f=0),t[0]=a,t[1]=c,t[2]=h,t[3]=0,t[4]=u,t[5]=l,t[6]=v,t[7]=0,t[8]=s,t[9]=f,t[10]=p,t[11]=0,t[12]=-(a*m+u*g+s*y),t[13]=-(c*m+l*g+f*y),t[14]=-(h*m+v*g+p*y),t[15]=1,t)},i.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.exports=i},{"./common.js":4}],9:[function(t,e,r){var n=t("./common.js"),i=t("./mat3.js"),o=t("./vec3.js"),a=t("./vec4.js"),u={};u.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.rotationTo=function(){var t=o.create(),e=o.fromValues(1,0,0),r=o.fromValues(0,1,0);return function(n,i,a){var s=o.dot(i,a);return-.999999>s?(o.cross(t,e,i),o.length(t)<1e-6&&o.cross(t,r,i),o.normalize(t,t),u.setAxisAngle(n,t,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(o.cross(t,i,a),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+s,u.normalize(n,n))}}(),u.setAxes=function(){var t=i.create();return function(e,r,n,i){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],u.normalize(e,u.fromMat3(e,t))}}(),u.clone=a.clone,u.fromValues=a.fromValues,u.copy=a.copy,u.set=a.set,u.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.setAxisAngle=function(t,e,r){r=.5*r;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t},u.add=a.add,u.multiply=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],u=r[0],s=r[1],c=r[2],l=r[3];return t[0]=n*l+a*u+i*c-o*s,t[1]=i*l+a*s+o*u-n*c,t[2]=o*l+a*c+n*s-i*u,t[3]=a*l-n*u-i*s-o*c,t},u.mul=u.multiply,u.scale=a.scale,u.rotateX=function(t,e,r){r*=.5;var n=e[0],i=e[1],o=e[2],a=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=n*s+a*u,t[1]=i*s+o*u,t[2]=o*s-i*u,t[3]=a*s-n*u,t},u.rotateY=function(t,e,r){r*=.5;var n=e[0],i=e[1],o=e[2],a=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=n*s-o*u,t[1]=i*s+a*u,t[2]=o*s+n*u,t[3]=a*s-i*u,t},u.rotateZ=function(t,e,r){r*=.5;var n=e[0],i=e[1],o=e[2],a=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=n*s+i*u,t[1]=i*s-n*u,t[2]=o*s+a*u,t[3]=a*s-o*u,t},u.calculateW=function(t,e){var r=e[0],n=e[1],i=e[2];return t[0]=r,t[1]=n,t[2]=i,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),t},u.dot=a.dot,u.lerp=a.lerp,u.slerp=function(t,e,r,n){var i,o,a,u,s,c=e[0],l=e[1],f=e[2],h=e[3],v=r[0],p=r[1],d=r[2],m=r[3];return o=c*v+l*p+f*d+h*m,0>o&&(o=-o,v=-v,p=-p,d=-d,m=-m),1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),u=Math.sin((1-n)*i)/a,s=Math.sin(n*i)/a):(u=1-n,s=n),t[0]=u*c+s*v,t[1]=u*l+s*p,t[2]=u*f+s*d,t[3]=u*h+s*m,t},u.sqlerp=function(){var t=u.create(),e=u.create();return function(r,n,i,o,a,s){return u.slerp(t,n,a,s),u.slerp(e,i,o,s),u.slerp(r,t,e,2*s*(1-s)),r}}(),u.invert=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r*r+n*n+i*i+o*o,u=a?1/a:0;return t[0]=-r*u,t[1]=-n*u,t[2]=-i*u,t[3]=o*u,t},u.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},u.length=a.length,u.len=u.length,u.squaredLength=a.squaredLength,u.sqrLen=u.squaredLength,u.normalize=a.normalize,u.fromMat3=function(t,e){var r,n=e[0]+e[4]+e[8];if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;r=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*a+a]+1),t[i]=.5*r,r=.5/r,t[3]=(e[3*o+a]-e[3*a+o])*r,t[o]=(e[3*o+i]+e[3*i+o])*r,t[a]=(e[3*a+i]+e[3*i+a])*r}return t},u.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exports=u},{"./common.js":4,"./mat3.js":7,"./vec3.js":11,"./vec4.js":12}],10:[function(t,e,r){var n=t("./common.js"),i={};i.create=function(){var t=new n.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},i.clone=function(t){var e=new n.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},i.fromValues=function(t,e){var r=new n.ARRAY_TYPE(2);return r[0]=t,r[1]=e,r},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},i.set=function(t,e,r){return t[0]=e,t[1]=r,t},i.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},i.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t},i.sub=i.subtract,i.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t},i.mul=i.multiply,i.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t},i.div=i.divide,i.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},i.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},i.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},i.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t},i.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(r*r+n*n)},i.dist=i.distance,i.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],r=t[1];return Math.sqrt(e*e+r*r)},i.len=i.length,i.squaredLength=function(t){var e=t[0],r=t[1];return e*e+r*r},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},i.normalize=function(t,e){var r=e[0],n=e[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},i.cross=function(t,e,r){var n=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=n,t},i.lerp=function(t,e,r,n){var i=e[0],o=e[1];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t},i.random=function(t,e){e=e||1;var r=2*n.RANDOM()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},i.transformMat2=function(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t},i.transformMat2d=function(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i+r[4],t[1]=r[1]*n+r[3]*i+r[5],t},i.transformMat3=function(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[3]*i+r[6],t[1]=r[1]*n+r[4]*i+r[7],t},i.transformMat4=function(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t},i.forEach=function(){var t=i.create();return function(e,r,n,i,o,a){var u,s;for(r||(r=2),n||(n=0),s=i?Math.min(i*r+n,e.length):e.length,u=n;s>u;u+=r)t[0]=e[u],t[1]=e[u+1],o(t,t,a),e[u]=t[0],e[u+1]=t[1];return e}}(),i.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},e.exports=i},{"./common.js":4}],11:[function(t,e,r){var n=t("./common.js"),i={};i.create=function(){var t=new n.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},i.clone=function(t){var e=new n.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},i.fromValues=function(t,e,r){var i=new n.ARRAY_TYPE(3);return i[0]=t,i[1]=e,i[2]=r,i},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},i.set=function(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t},i.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},i.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t},i.sub=i.subtract,i.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t},i.mul=i.multiply,i.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t},i.div=i.divide,i.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},i.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},i.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},i.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t},i.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(r*r+n*n+i*i)},i.dist=i.distance,i.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return r*r+n*n+i*i},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)},i.len=i.length,i.squaredLength=function(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},i.normalize=function(t,e){var r=e[0],n=e[1],i=e[2],o=r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},i.cross=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[0],u=r[1],s=r[2];return t[0]=i*s-o*u,t[1]=o*a-n*s,t[2]=n*u-i*a,t},i.lerp=function(t,e,r,n){var i=e[0],o=e[1],a=e[2];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t[2]=a+n*(r[2]-a),t},i.hermite=function(t,e,r,n,i,o){var a=o*o,u=a*(2*o-3)+1,s=a*(o-2)+o,c=a*(o-1),l=a*(3-2*o);return t[0]=e[0]*u+r[0]*s+n[0]*c+i[0]*l,t[1]=e[1]*u+r[1]*s+n[1]*c+i[1]*l,t[2]=e[2]*u+r[2]*s+n[2]*c+i[2]*l,t},i.bezier=function(t,e,r,n,i,o){var a=1-o,u=a*a,s=o*o,c=u*a,l=3*o*u,f=3*s*a,h=s*o;return t[0]=e[0]*c+r[0]*l+n[0]*f+i[0]*h,t[1]=e[1]*c+r[1]*l+n[1]*f+i[1]*h,t[2]=e[2]*c+r[2]*l+n[2]*f+i[2]*h,t},i.random=function(t,e){e=e||1;var r=2*n.RANDOM()*Math.PI,i=2*n.RANDOM()-1,o=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(r)*o,t[1]=Math.sin(r)*o,t[2]=i*e,t},i.transformMat4=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[3]*n+r[7]*i+r[11]*o+r[15];return a=a||1,t[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/a,t[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/a,t[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/a,t},i.transformMat3=function(t,e,r){var n=e[0],i=e[1],o=e[2];return t[0]=n*r[0]+i*r[3]+o*r[6],t[1]=n*r[1]+i*r[4]+o*r[7],t[2]=n*r[2]+i*r[5]+o*r[8],t},i.transformQuat=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[0],u=r[1],s=r[2],c=r[3],l=c*n+u*o-s*i,f=c*i+s*n-a*o,h=c*o+a*i-u*n,v=-a*n-u*i-s*o;return t[0]=l*c+v*-a+f*-s-h*-u,t[1]=f*c+v*-u+h*-a-l*-s,t[2]=h*c+v*-s+l*-u-f*-a,
t},i.rotateX=function(t,e,r,n){var i=[],o=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],o[0]=i[0],o[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),o[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},i.rotateY=function(t,e,r,n){var i=[],o=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],o[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),o[1]=i[1],o[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},i.rotateZ=function(t,e,r,n){var i=[],o=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],o[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),o[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),o[2]=i[2],t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},i.forEach=function(){var t=i.create();return function(e,r,n,i,o,a){var u,s;for(r||(r=3),n||(n=0),s=i?Math.min(i*r+n,e.length):e.length,u=n;s>u;u+=r)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],o(t,t,a),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2];return e}}(),i.angle=function(t,e){var r=i.fromValues(t[0],t[1],t[2]),n=i.fromValues(e[0],e[1],e[2]);i.normalize(r,r),i.normalize(n,n);var o=i.dot(r,n);return o>1?0:Math.acos(o)},i.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},e.exports=i},{"./common.js":4}],12:[function(t,e,r){var n=t("./common.js"),i={};i.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},i.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},i.fromValues=function(t,e,r,i){var o=new n.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=r,o[3]=i,o},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},i.set=function(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t},i.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},i.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t},i.sub=i.subtract,i.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t},i.mul=i.multiply,i.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t},i.div=i.divide,i.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},i.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},i.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},i.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},i.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(r*r+n*n+i*i+o*o)},i.dist=i.distance,i.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return r*r+n*n+i*i+o*o},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],r=t[1],n=t[2],i=t[3];return Math.sqrt(e*e+r*r+n*n+i*i)},i.len=i.length,i.squaredLength=function(t){var e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},i.normalize=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r*r+n*n+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=r*a,t[1]=n*a,t[2]=i*a,t[3]=o*a),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},i.lerp=function(t,e,r,n){var i=e[0],o=e[1],a=e[2],u=e[3];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t[2]=a+n*(r[2]-a),t[3]=u+n*(r[3]-u),t},i.random=function(t,e){return e=e||1,t[0]=n.RANDOM(),t[1]=n.RANDOM(),t[2]=n.RANDOM(),t[3]=n.RANDOM(),i.normalize(t,t),i.scale(t,t,e),t},i.transformMat4=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,t[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,t[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,t[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,t},i.transformQuat=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[0],u=r[1],s=r[2],c=r[3],l=c*n+u*o-s*i,f=c*i+s*n-a*o,h=c*o+a*i-u*n,v=-a*n-u*i-s*o;return t[0]=l*c+v*-a+f*-s-h*-u,t[1]=f*c+v*-u+h*-a-l*-s,t[2]=h*c+v*-s+l*-u-f*-a,t[3]=e[3],t},i.forEach=function(){var t=i.create();return function(e,r,n,i,o,a){var u,s;for(r||(r=4),n||(n=0),s=i?Math.min(i*r+n,e.length):e.length,u=n;s>u;u+=r)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],o(t,t,a),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}}(),i.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exports=i},{"./common.js":4}],13:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=function(){function t(e,r){n(this,t),this._array=e,this.itemSize=r,this.length=e.length/r,this.type=t.ArrayBuffer,this._preparedGlContext=null}return i(t,[{key:"bind",value:function(e,r){return this._preparedGlContext!==e&&this._unprepare(this._preparedGlContext),this._glBuffer||this._prepare(e),this.type===t.ArrayBuffer?(e.bindBuffer(e.ARRAY_BUFFER,this._glBuffer),e.vertexAttribPointer(r,this.itemSize,e.FLOAT,!1,0,0)):this.type===t.ElementArrayBuffer&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._glBuffer),this}},{key:"remove",value:function(t){return this._unprepare(t),this}},{key:"getArray",value:function(){return this._array}},{key:"getElement",value:function(t){return this._array.subarray(t*this.itemSize,(t+1)*this.itemSize)}},{key:"getTriangle",value:function(t){return t*=3,[this.getElement(t),this.getElement(t+1),this.getElement(t+2)]}},{key:"concat",value:function(t){var e=t.getArray(),r=new this._array.constructor(this._array.length+e.length);r.set(this._array,0),r.set(e,this._array.length),this._array=r,this.length=r.length/this.itemSize}},{key:"_prepare",value:function(t){this._glBuffer=t.createBuffer(),t.bindBuffer(this._toGlParam(t,this.type),this._glBuffer),t.bufferData(this._toGlParam(t,this.type),this._array,t.STATIC_DRAW),this._preparedGlContext=t}},{key:"_unprepare",value:function(t){t&&(this._glBuffer&&t.deleteBuffer(this._glBuffer),this._glBuffer=null)}},{key:"_toGlParam",value:function(e,r){return r===t.ArrayBuffer?e.ARRAY_BUFFER:r===t.ElementArrayBuffer?e.ELEMENT_ARRAY_BUFFER:void 0}}]),t}();o.ArrayBuffer=1,o.ElementArrayBuffer=2,r.default=o,e.exports=r.default},{}],14:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=t("gl-matrix"),u=t("./Buffer"),s=n(u),c=t("./math/Box"),l=n(c),f=function(){function t(){i(this,t),this.buffers={},this._boundingBox=null}return o(t,[{key:"setBuffer",value:function(t,e){return this.buffers[t]=e,this}},{key:"getBuffer",value:function(t){return this.buffers[t]}},{key:"computeNormals",value:function(){var t=this.buffers.position;if(!t)return this;for(var e=new Float32Array(t.length*t.itemSize),r=a.vec3.create(),n=a.vec3.create(),i=a.vec3.create(),o=0;o<t.length;o+=3){var u=t.getTriangle(o/3);a.vec3.sub(r,u[0],u[1]),a.vec3.sub(n,u[2],u[1]),a.vec3.cross(i,r,n),a.vec3.normalize(i,i),e.set(i,3*o),e.set(i,3*(o+1)),e.set(i,3*(o+2))}return this.setBuffer("normal",new s.default(e,3)),this}},{key:"getBoundingBox",value:function(){return this._boundingBox||this.computeBoundingBox(),this._boundingBox}},{key:"computeBoundingBox",value:function(){var t=this._boundingBox=new l.default,e=this.buffers.position;if(e)for(var r=0;r<e.length;r++)t.expandByPoint(e.getElement(r))}},{key:"concat",value:function(t){for(var e in this.buffers)this.buffers[e].concat(t.buffers[e])}}]),t}();r.default=f,e.exports=r.default},{"./Buffer":13,"./math/Box":28,"gl-matrix":3}],15:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function(t,e,r){for(var n=!0;n;){var i=t,o=e,a=r;u=c=s=void 0,n=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var c=Object.getPrototypeOf(i);if(null===c)return void 0;t=c,e=o,r=a,n=!0}},s=t("./Object3D"),c=n(s),l=t("gl-matrix"),f=function(t){function e(t,r){i(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.geometry=t,this.program=r}return o(e,t),a(e,[{key:"render",value:function(t){var e=t.gl;return this.visible?(this.worldMatrixNeedsUpdate&&this.updateWorldMatrix(),t.object=this,this.program.enable(t),e.drawArrays(e.TRIANGLES,0,this.geometry.getBuffer("position").length),this.program.disable(e),this):this}},{key:"raycast",value:function(t,e,r){var n=l.mat4.create();l.mat4.invert(n,this.worldMatrix);var i=t.ray.clone();i.applyMatrix4(n);var o=this.geometry.getBoundingBox();if(!i.intersectBox(o))return this;for(var a=this.geometry.buffers.position,u=0;u<a.length;u+=3){var s=a.getTriangle(u/3),c=i.intersectTriangle(s,!1);if(c){l.vec3.transformMat4(c,c,this.worldMatrix);var f=l.vec3.dist(t.ray.origin,c);f<t.precision||f<t.near||f>t.far||e.push({distance:f,point:c,object:this})}}return r&&this.children.forEach(function(n){return n.raycast(t,e,r)}),this}},{key:"typifyForRender",value:function(t){return this.visible?(this.program.typifyForRender(t,this),this.children.forEach(function(e){return e.typifyForRender(t)}),this):this}}]),e}(c.default);r.default=f,e.exports=r.default},{"./Object3D":16,"gl-matrix":3}],16:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("gl-matrix"),a=function(){function t(){n(this,t),this.children=[],this.parent=null,this.visible=!0,this.renderOrder=0,this.scale=o.vec3.fromValues(1,1,1),this.position=o.vec3.create(),this.quaternion=o.quat.create(),this.localMatrix=o.mat4.create(),this.worldMatrix=o.mat4.create(),this.worldMatrixNeedsUpdate=!1}return i(t,[{key:"add",value:function(t){return t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),this}},{key:"remove",value:function(t){var e=this.children.indexOf(t);return-1!=e&&(t.parent=null,this.children.splice(e,1)),this}},{key:"raycast",value:function(t,e,r){return r&&this.children.forEach(function(n){return n.raycast(t,e,r)}),this}},{key:"render",value:function(t){return this.visible?(this.worldMatrixNeedsUpdate&&this.updateWorldMatrix(),this):void 0}},{key:"updateLocalMatrix",value:function(){return o.mat4.fromRotationTranslationScale(this.localMatrix,this.quaternion,this.position,this.scale),this.worldMatrixNeedsUpdate=!0,this}},{key:"updateWorldMatrix",value:function(){return this.parent?o.mat4.mul(this.worldMatrix,this.parent.worldMatrix,this.localMatrix):o.mat4.copy(this.worldMatrix,this.localMatrix),this.children.forEach(function(t){return t.updateWorldMatrix()}),this.worldMatrixNeedsUpdate=!1,this}},{key:"getWorldPosition",value:function(){return o.vec3.fromValues(this.worldMatrix[12],this.worldMatrix[13],this.worldMatrix[14])}},{key:"traverse",value:function(t){return t(this),this.children.forEach(function(e){return e.traverse(t)}),this}},{key:"traverseVisible",value:function(t){return this.visible?(t(this),this.children.forEach(function(e){return e.traverseVisible(t)}),this):this}},{key:"typifyForRender",value:function(t){return this.visible?(t.common.push(this),this.children.forEach(function(e){return e.typifyForRender(t)}),this):this}}]),t}();r.default=a,e.exports=r.default},{"gl-matrix":3}],17:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=t("gl-matrix"),u=t("./math/Ray"),s=n(u),c=t("./cameras/OrthographicCamera"),l=n(c),f=t("./cameras/PerspectiveCamera"),h=n(f),v=function(){function t(e,r,n,o){i(this,t),this.precision=1e-4,this.ray=new s.default(e,r),this.near=n||0,this.far=o||1/0}return o(t,[{key:"setFromCamera",value:function(t,e){if(e instanceof h.default){this.ray.origin=a.vec3.clone(e.position);var r=a.vec3.fromValues(t[0],t[1],.5);r=e.unproject(r),a.vec3.sub(r,r,e.position),a.vec3.normalize(r,r),this.ray.direction=r}else if(e instanceof l.default){var n=a.vec3.fromValues(t[0],t[1],-1);this.ray.origin=e.unproject(n),this.ray.direction=a.vec3.fromValues(0,0,-1);var i=a.mat3.create();a.mat3.fromMat4(i,e.worldMatrix),a.vec3.transformMat3(this.ray.direction,this.ray.direction,i),a.vec3.normalize(this.ray.direction,this.ray.direction)}}},{key:"intersectObject",value:function(t,e){var r=[];return t.raycast(this,r,e),r.sort(this._descSort),r}},{key:"intersectObjects",value:function(t,e){var r=this,n=[];return t.forEach(function(t){return t.raycast(r,n,e)}),n.sort(this._descSort),n}},{key:"_descSort",value:function(t,e){return t.distance-e.distance}}]),t}();r.default=v,e.exports=r.default},{"./cameras/OrthographicCamera":22,"./cameras/PerspectiveCamera":23,"./math/Ray":32,"gl-matrix":3}],18:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function(t,e,r){for(var n=!0;n;){var i=t,o=e,a=r;u=c=s=void 0,n=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var c=Object.getPrototypeOf(i);if(null===c)return void 0;t=c,e=o,r=a,n=!0}},s=t("./Object3D"),c=n(s),l=function(t){function e(){i(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this._lights=[]}return o(e,t),a(e,[{key:"addLight",value:function(t){return this._lights.push(t),this}},{key:"getLights",value:function(){return this._lights}}]),e}(c.default);r.default=l,e.exports=r.default},{"./Object3D":16}],19:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function(t,e,r){for(var n=!0;n;){var i=t,o=e,a=r;u=c=s=void 0,n=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var c=Object.getPrototypeOf(i);if(null===c)return void 0;t=c,e=o,r=a,n=!0}},s=t("./Object3D"),c=n(s),l=t("gl-matrix"),f=function(t){function e(t){i(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.program=t,this.offset=l.vec2.create()}return o(e,t),a(e,[{key:"render",value:function(t){if(!this.visible)return this;this.worldMatrixNeedsUpdate&&this.updateWorldMatrix();var e=t.gl;return t.object=this,this.program.enable(t),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),this.program.disable(t.gl),this}},{key:"typifyForRender",value:function(t){return this.visible?(this.program.typifyForRender(t,this),this.children.forEach(function(e){return e.typifyForRender(t)}),this):this}}]),e}(c.default);r.default=f,e.exports=r.default},{"./Object3D":16,"gl-matrix":3}],20:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=function(){function t(e){n(this,t),this._src=e,this.magFilter=t.LinearFilter,this.minFilter=t.LinearMipMapLinearFilter,this.wrapS=t.ClampToEdgeWrapping,this.wrapT=t.ClampToEdgeWrapping,this.generateMipmaps=!0}return i(t,[{key:"enable",value:function(t,e){return this._texture||this._prepare(t),t.bindTexture(t.TEXTURE_2D,this._texture),e&&(t.activeTexture(t.TEXTURE0),t.uniform1i(e,0)),this}},{key:"_prepare",value:function(e){this._texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this._texture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._src),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,this._toGlParam(e,this.wrapS)),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,this._toGlParam(e,this.wrapT)),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,this._toGlParam(e,this.magFilter)),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,this._toGlParam(e,this.minFilter)),this.generateMipmaps&&this.minFilter!==t.NearestFilter&&this.minFilter!==t.LinearFilter&&e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null)}},{key:"_toGlParam",value:function(e,r){return r===t.ClampToEdgeWrapping?e.CLAMP_TO_EDGE:r===t.NearestFilter?e.NEAREST:r===t.NearestMipMapNearestFilter?e.NEAREST_MIPMAP_NEAREST:r===t.NearestMipMapLinearFilter?e.NEAREST_MIPMAP_LINEAR:r===t.LinearFilter?e.LINEAR:r===t.LinearMipMapNearestFilter?e.LINEAR_MIPMAP_NEAREST:r===t.LinearMipMapLinearFilter?e.LINEAR_MIPMAP_LINEAR:void 0}}]),t}();o.ClampToEdgeWrapping=8,o.NearestFilter=1,o.NearestMipMapNearestFilter=2,o.NearestMipMapLinearFilter=3,o.LinearFilter=4,o.LinearMipMapNearestFilter=5,o.LinearMipMapLinearFilter=6,r.default=o,e.exports=r.default},{}],21:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function(t,e,r){for(var n=!0;n;){var i=t,o=e,a=r;u=c=s=void 0,n=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var c=Object.getPrototypeOf(i);if(null===c)return void 0;t=c,e=o,r=a,n=!0}},s=t("../Object3D"),c=n(s),l=t("gl-matrix"),f=function(t){function e(){i(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.up=l.vec3.fromValues(0,1,0),this.projectionMatrix=l.mat4.create(),this.modelViewMatrix=l.mat4.create(),this.worldInverseMatrix=l.mat4.create()}return o(e,t),a(e,[{key:"updateProjectionMatrix",value:function(){}},{key:"updateWorldMatrix",value:function(){u(Object.getPrototypeOf(e.prototype),"updateWorldMatrix",this).call(this),l.mat4.invert(this.worldInverseMatrix,this.worldMatrix),l.mat4.multiply(this.modelViewMatrix,this.projectionMatrix,this.worldInverseMatrix)}},{key:"project",value:function(t){var e=l.vec3.create();return l.vec3.transformMat4(e,t,this.modelViewMatrix),e}},{key:"unproject",value:function(t){var e=l.mat4.create(),r=l.mat4.create(),n=l.vec3.create();return l.mat4.invert(r,this.projectionMatrix),l.mat4.mul(e,this.worldMatrix,r),l.vec3.transformMat4(n,t,e),n}},{key:"lookAt",value:function(t){var e=l.mat4.create(),r=l.mat3.create();return l.mat4.lookAt(e,this.position,t,this.up),l.mat4.transpose(e,e),l.mat3.fromMat4(r,e),l.quat.fromMat3(this.quaternion,r),this}}]),e}(c.default);r.default=f,e.exports=r.default},{"../Object3D":16,"gl-matrix":3}],22:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function(t,e,r){for(var n=!0;n;){var i=t,o=e,a=r;u=c=s=void 0,n=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var c=Object.getPrototypeOf(i);if(null===c)return void 0;t=c,e=o,r=a,n=!0}},s=t("gl-matrix"),c=t("./Camera"),l=n(c),f=function(t){function e(t,r,n,o,a,s){i(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.left=t,this.right=r,this.top=n,this.bottom=o,this.near=a,this.far=s}return o(e,t),a(e,[{key:"updateProjectionMatrix",value:function(){s.mat4.ortho(this.projectionMatrix,this.left,this.right,this.bottom,this.top,this.near,this.far)}}]),e}(l.default);r.default=f,e.exports=r.default},{"./Camera":21,"gl-matrix":3}],23:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function(t,e,r){for(var n=!0;n;){var i=t,o=e,a=r;u=c=s=void 0,n=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var c=Object.getPrototypeOf(i);if(null===c)return void 0;t=c,e=o,r=a,n=!0}},s=t("gl-matrix"),c=t("./Camera"),l=n(c),f=t("../math/Math"),h=function(t){function e(t,r,n,o){i(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.fov=t,this.aspect=r,this.near=n,this.far=o}return o(e,t),a(e,[{key:"updateProjectionMatrix",value:function(){s.mat4.perspective(this.projectionMatrix,f.degToRad(this.fov),this.aspect,this.near,this.far)}}]),e}(l.default);r.default=h,e.exports=r.default},{"../math/Math":30,"./Camera":21,"gl-matrix":3}],24:[function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function i(t){return t&&t.__esModule?t:{default:t}}var o=t("./renderer/Renderer"),a=i(o),u=t("./Object3D"),s=i(u),c=t("./cameras/PerspectiveCamera"),l=i(c),f=t("./cameras/OrthographicCamera"),h=i(f),v=t("./Buffer"),p=i(v),d=t("./Geometry"),m=i(d),g=t("./programs/BasicMeshProgram"),y=i(g),b=t("./programs/ComplexMeshProgram"),_=i(b),M=t("./programs/SpriteProgram"),x=i(M),P=t("./Mesh"),w=i(P),O=t("./Sprite"),E=i(O),A=t("./Scene"),j=i(A),T=t("./Texture"),R=i(T),C=t("./lights/AmbientLight"),L=i(C),S=t("./lights/DirectionalLight"),k=i(S),D=t("./Raycaster"),F=i(D),N=t("./math/Ray"),B=i(N),U=t("./math/Plane"),q=i(U),I=t("./math/Box"),Y=i(I),z=t("./math/Math"),G=n(z),V=t("./math/Line3"),H=i(V),W=t("gl-matrix");W.glMatrix.ARRAY_TYPE="undefined"!=typeof Float64Array?Float64Array:Array;var X={Renderer:a.default,Object3D:s.default,PerspectiveCamera:l.default,OrthographicCamera:h.default,Buffer:p.default,Geometry:m.default,Mesh:w.default,Sprite:E.default,BasicMeshProgram:y.default,ComplexMeshProgram:_.default,SpriteProgram:x.default,Scene:j.default,Texture:R.default,AmbientLight:L.default,DirectionalLight:k.default,Raycaster:F.default,Ray:B.default,Plane:q.default,Box:Y.default,Line3:H.default,Math:G,vec3:W.vec3,mat3:W.mat3,mat4:W.mat4,quat:W.quat};e.exports=X},{"./Buffer":13,"./Geometry":14,"./Mesh":15,"./Object3D":16,"./Raycaster":17,"./Scene":18,"./Sprite":19,"./Texture":20,"./cameras/OrthographicCamera":22,"./cameras/PerspectiveCamera":23,"./lights/AmbientLight":25,"./lights/DirectionalLight":26,"./math/Box":28,"./math/Line3":29,"./math/Math":30,"./math/Plane":31,"./math/Ray":32,"./programs/BasicMeshProgram":33,"./programs/ComplexMeshProgram":34,"./programs/SpriteProgram":36,"./renderer/Renderer":38,"gl-matrix":3}],25:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(t,e,r){for(var n=!0;n;){var i=t,o=e,a=r;u=c=s=void 0,n=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var c=Object.getPrototypeOf(i);if(null===c)return void 0;t=c,e=o,r=a,n=!0}},u=t("./Light"),s=n(u),c=function(t){function e(t){i(this,e),a(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return o(e,t),e}(s.default);r.default=c,e.exports=r.default},{"./Light":27}],26:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(t,e,r){for(var n=!0;n;){var i=t,o=e,a=r;u=c=s=void 0,n=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var c=Object.getPrototypeOf(i);if(null===c)return void 0;t=c,e=o,r=a,n=!0}},u=t("./Light"),s=n(u),c=function(t){function e(t){i(this,e),a(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return o(e,t),e}(s.default);r.default=c,e.exports=r.default},{"./Light":27}],27:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(t,e,r){for(var n=!0;n;){var i=t,o=e,a=r;u=c=s=void 0,n=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var c=Object.getPrototypeOf(i);if(null===c)return void 0;t=c,e=o,r=a,n=!0}},u=t("../Object3D"),s=n(u),c=function(t){function e(t){i(this,e),a(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.color=t}return o(e,t),e}(s.default);r.default=c,e.exports=r.default},{"../Object3D":16}],28:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("gl-matrix"),a=function(){function t(e,r){n(this,t),this.min=e||o.vec3.create(),this.max=r||o.vec3.create()}return i(t,[{key:"containsPoint",value:function(t){return t[0]>this.min[0]&&t[0]<this.max[0]&&t[1]>this.min[1]&&t[1]<this.max[1]&&t[2]>this.min[2]&&t[2]<this.max[2]}},{key:"expandByPoint",value:function(t){return o.vec3.min(this.min,this.min,t),o.vec3.max(this.max,this.max,t),this}}]),t}();r.default=a,e.exports=r.default},{"gl-matrix":3}],29:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("gl-matrix"),a=t("./Math.js"),u=function(){function t(e,r){n(this,t),this.start=e||o.vec3.create(),
this.end=r||o.vec3.create()}return i(t,[{key:"closestPointToPointParameter",value:function(t,e){var r=o.vec3.create(),n=o.vec3.create();o.vec3.sub(r,t,this.start),o.vec3.sub(n,this.end,this.start);var i=o.vec3.dot(n,n),u=o.vec3.dot(n,r),s=u/i;return e&&(s=a.clamp(s,0,1)),s}},{key:"closestPointToPoint",value:function(t,e,r){var n=this.closestPointToPointParameter(t,e),i=r||o.vec3.create();return i=this.delta(i),o.vec3.scale(i,i,n),o.vec3.add(i,i,this.start),i}},{key:"delta",value:function(t){var e=t||o.vec3.create();return o.vec3.sub(e,this.end,this.start),e}}]),t}();r.default=u,e.exports=r.default},{"./Math.js":30,"gl-matrix":3}],30:[function(t,e,r){"use strict";function n(t,e,r){return e>t?e:t>r?r:t}function i(t){return t*Math.PI/180}Object.defineProperty(r,"__esModule",{value:!0}),r.clamp=n,r.degToRad=i},{}],31:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("gl-matrix"),a=function(){function t(e,r){n(this,t),this.normal=e||o.vec3.create(),this.constant=r||0}return i(t,[{key:"distanceToPoint",value:function(t){return o.vec3.dot(this.normal,t)+this.constant}}]),t}();r.default=a,e.exports=r.default},{"gl-matrix":3}],32:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("gl-matrix"),a=function(){function t(e,r){n(this,t),this.origin=e||o.vec3.create(),this.direction=r||o.vec3.create()}return i(t,[{key:"clone",value:function(){return new t(o.vec3.clone(this.origin),o.vec3.clone(this.direction))}},{key:"at",value:function(t){var e=o.vec3.create();return o.vec3.scaleAndAdd(e,this.origin,this.direction,t),e}},{key:"intersectBox",value:function(t){var e=void 0,r=void 0,n=void 0,i=void 0,o=void 0,a=void 0,u=1/this.direction[0],s=1/this.direction[1],c=1/this.direction[2],l=this.origin;return u>=0?(e=(t.min[0]-l[0])*u,r=(t.max[0]-l[0])*u):(e=(t.max[0]-l[0])*u,r=(t.min[0]-l[0])*u),s>=0?(n=(t.min[1]-l[1])*s,i=(t.max[1]-l[1])*s):(n=(t.max[1]-l[1])*s,i=(t.min[1]-l[1])*s),e>i||n>r?null:((n>e||e!==e)&&(e=n),(r>i||r!==r)&&(r=i),c>=0?(o=(t.min[2]-l[2])*c,a=(t.max[2]-l[2])*c):(o=(t.max[2]-l[2])*c,a=(t.min[2]-l[2])*c),e>a||o>r?null:((o>e||e!==e)&&(e=o),(r>a||r!==r)&&(r=a),0>r?null:this.at(e>=0?e:r)))}},{key:"applyMatrix4",value:function(t){return o.vec3.add(this.direction,this.direction,this.origin),o.vec3.transformMat4(this.direction,this.direction,t),o.vec3.transformMat4(this.origin,this.origin,t),o.vec3.sub(this.direction,this.direction,this.origin),o.vec3.normalize(this.direction,this.direction),this}},{key:"intersectTriangle",value:function(t,e){var r=o.vec3.create(),n=o.vec3.create(),i=o.vec3.create();o.vec3.sub(r,t[1],t[0]),o.vec3.sub(n,t[2],t[0]),o.vec3.cross(i,r,n);var a,u=o.vec3.dot(this.direction,i);if(u>0){if(e)return null;a=1}else{if(!(0>u))return null;a=-1,u=-u}var s=o.vec3.create();o.vec3.sub(s,this.origin,t[0]);var c=o.vec3.create();o.vec3.cross(c,s,n);var l=a*o.vec3.dot(this.direction,c);if(0>l)return null;var f=o.vec3.create();o.vec3.cross(f,r,s);var h=a*o.vec3.dot(this.direction,f);if(0>h)return null;if(l+h>u)return null;var v=-a*o.vec3.dot(s,i);return 0>v?null:this.at(v/u)}},{key:"distanceToPlane",value:function(t){var e=o.vec3.dot(t.normal,this.direction);if(0==e)return 0==t.distanceToPoint(this.origin)?0:null;var r=-(o.vec3.dot(this.origin,t.normal)+t.constant)/e;return r>=0?r:null}},{key:"intersectPlane",value:function(t){var e=this.distanceToPlane(t);return null===e?null:this.at(e)}}]),t}();r.default=a,e.exports=r.default},{"gl-matrix":3}],33:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function(t,e,r){for(var n=!0;n;){var i=t,o=e,a=r;u=c=s=void 0,n=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var c=Object.getPrototypeOf(i);if(null===c)return void 0;t=c,e=o,r=a,n=!0}},s=t("../shaders"),c=t("./Program"),l=n(c),f=function(t){function e(){i(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this._attributeList=["position"],this._uniformList=["uCamera","uPosition","uColor","uColorAlpha"],this._shader=s.basic,this.color=[0,0,0]}return o(e,t),a(e,[{key:"_bindUniforms",value:function(t){var e=t.gl,r=t.camera,n=t.object;e.uniformMatrix4fv(this.uniforms.uPosition,!1,new Float32Array(n.worldMatrix)),e.uniformMatrix4fv(this.uniforms.uCamera,!1,new Float32Array(r.modelViewMatrix)),e.uniform1f(this.uniforms.uColorAlpha,this.opacity),e.uniform3fv(this.uniforms.uColor,this.color)}}]),e}(l.default);r.default=f,e.exports=r.default},{"../shaders":41,"./Program":35}],34:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function(t,e,r){for(var n=!0;n;){var i=t,o=e,a=r;u=c=s=void 0,n=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var c=Object.getPrototypeOf(i);if(null===c)return void 0;t=c,e=o,r=a,n=!0}},s=t("../shaders"),c=t("gl-matrix"),l=t("./Program"),f=n(l),h=t("../lights/AmbientLight"),v=n(h),p=t("../lights/DirectionalLight"),d=n(p),m=function(t){function e(){i(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this._attributeList=["position","color","emissive"],this._uniformList=["uCamera","uPosition","uColorAlpha","uAmbientLightColor"],this._shader=s.complex,this._texture=null}return o(e,t),a(e,[{key:"setTexture",value:function(t){return this._texture=t,this}},{key:"getTexture",value:function(){return this._texture}},{key:"_prepare",value:function(t){this._enableLight(t),this._texture&&this._enableTexture(),u(Object.getPrototypeOf(e.prototype),"_prepare",this).call(this,t)}},{key:"_enableLight",value:function(t){var e=t.scene,r=0;e.getLights().forEach(function(t){t instanceof d.default&&r++}),this.define("directionLights",r),r>0&&(this._attributeList.push("normal"),this._uniformList.push("uDirectionLightColors","uDirectionLightPositions","uNormalMatrix"))}},{key:"_enableTexture",value:function(){this.define("texture"),this._attributeList.push("texture","textureEnable"),this._uniformList.push("uTexture")}},{key:"_bindMesh",value:function(t){var e=this,r=t.gl,n=t.scene,i=t.camera,o=t.object;this._texture&&this._texture.enable(r,this.uniforms.uTexture);var a=n.getLights();a.length&&!function(){var t=[],n=[];if(a.forEach(function(i){if(i instanceof v.default)r.uniform3fv(e.uniforms.uAmbientLightColor,i.color);else if(i instanceof d.default){t=t.concat(i.color);var o=c.vec3.create();c.vec3.scale(o,i.position,-1),n=n.concat(Array.prototype.slice.call(o))}}),t.length&&n.length){var i=c.mat3.create();c.mat3.fromMat4(i,o.worldMatrix),c.mat3.invert(i,i),c.mat3.transpose(i,i),r.uniformMatrix3fv(e.uniforms.uNormalMatrix,!1,new Float32Array(i)),o.geometry.getBuffer("normal").bind(r,e.attributes.normal)}r.uniform3fv(e.uniforms.uDirectionLightColors,new Float32Array(t)),r.uniform3fv(e.uniforms.uDirectionLightPositions,new Float32Array(n))}(),this._attributeList.forEach(function(t){"normal"!==t&&o.geometry.getBuffer(t).bind(r,e.attributes[t])}),r.uniformMatrix4fv(this.uniforms.uPosition,!1,new Float32Array(o.worldMatrix)),r.uniformMatrix4fv(this.uniforms.uCamera,!1,new Float32Array(i.modelViewMatrix)),r.uniform1f(this.uniforms.uColorAlpha,this.opacity)}}]),e}(f.default);r.default=m,e.exports=r.default},{"../lights/AmbientLight":25,"../lights/DirectionalLight":26,"../shaders":41,"./Program":35,"gl-matrix":3}],35:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=t("./definitions"),u=n(a),s={},c=function(){function t(){i(this,t),this._attributeList=[],this._uniformList=[],this._definitions=[],this._shader=null,this.opacity=1}return o(t,[{key:"enable",value:function(t){var e=t.gl;this._shaderProgram||this._prepare(t),e.useProgram(this._shaderProgram);for(var r in this.attributes)e.enableVertexAttribArray(this.attributes[r]);return this._bindMesh(t),this}},{key:"disable",value:function(t){for(var e in this.attributes)t.disableVertexAttribArray(this.attributes[e]);return this}},{key:"define",value:function(t,e){return u.default[t]&&this._definitions.push({type:t,value:e}),this}},{key:"typifyForRender",value:function(t,e){1===this.opacity?t.common.push(e):t.transparent.push(e)}},{key:"_prepare",value:function(t){this._prepareShaders(t),this._prepareAttributes(t),this._prepareUniforms(t)}},{key:"_getCachedProgramKey",value:function(){return this.constructor.name+":"+this._definitions.join(":")}},{key:"_getCachedProgram",value:function(){return s[this._getCachedProgramKey()]}},{key:"_prepareShaders",value:function(t){var e=t.gl,r=this._getCachedProgram();if(r&&e===r.glContext)return void(this._shaderProgram=r.program);var n=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(n,this._addDefinitions(this._shader.fragment)),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)||console.log(e.getShaderInfoLog(n));var i=e.createShader(e.VERTEX_SHADER);e.shaderSource(i,this._addDefinitions(this._shader.vertex)),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)||console.log(e.getShaderInfoLog(i)),this._shaderProgram=e.createProgram(),e.attachShader(this._shaderProgram,i),e.attachShader(this._shaderProgram,n),e.linkProgram(this._shaderProgram),e.getProgramParameter(this._shaderProgram,e.LINK_STATUS)||console.log("Could not initialize shaders"),s[this._getCachedProgramKey()]={glContext:e,program:this._shaderProgram}}},{key:"_addDefinitions",value:function(t){return this._definitions.map(function(t){return void 0!==t.value?"#define "+u.default[t.type]+" "+t.value:"#define "+u.default[t.type]}).join("\n")+"\n"+t}},{key:"_prepareAttributes",value:function(t){var e=this,r=t.gl;this.attributes={},this._attributeList.forEach(function(t){e.attributes[t]=r.getAttribLocation(e._shaderProgram,t)})}},{key:"_prepareUniforms",value:function(t){var e=this,r=t.gl;this.uniforms={},this._uniformList.forEach(function(t){e.uniforms[t]=r.getUniformLocation(e._shaderProgram,t)})}},{key:"_bindMesh",value:function(t){this._bindAttributes(t),this._bindUniforms(t)}},{key:"_bindAttributes",value:function(t){var e=this,r=t.gl,n=t.object;this._attributeList.forEach(function(t){n.geometry.getBuffer(t).bind(r,e.attributes[t])})}},{key:"_bindUniforms",value:function(t){var e=t.gl,r=t.object,n=t.camera;e.uniformMatrix4fv(this.uniforms.uPosition,!1,new Float32Array(r.worldMatrix)),e.uniformMatrix4fv(this.uniforms.uCamera,!1,new Float32Array(n.modelViewMatrix)),e.uniform1f(this.uniforms.uColorAlpha,this.opacity)}}]),t}();r.default=c,e.exports=r.default},{"./definitions":37}],36:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=function(){function t(){n(this,t),this.opacity=1,this.smoothing=!1,this._texture=null}return i(t,[{key:"setTexture",value:function(t){return this._texture=t,this}},{key:"getTexture",value:function(){return this._texture}},{key:"enable",value:function(t){var e=t.gl,r=t.object,n=t.uniforms,i=t.renderer;e.uniform1f(n.uColorAlpha,this.opacity),e.uniform1i(n.uSmoothing,Number(this.smoothing));var o=i.getSize();e.uniform2f(n.uHalfSize,o[0]/2,o[1]/2),e.uniform2f(n.uOffset,r.offset[0],r.offset[1]),e.uniform2f(n.uScale,r.scale[0],r.scale[1]),e.uniform3f(n.uPosition,r.worldMatrix[12],r.worldMatrix[13],r.worldMatrix[14]),this._texture&&this._texture.enable(e)}},{key:"disable",value:function(){}},{key:"typifyForRender",value:function(t,e){t.sprites.push(e)}}]),t}();r.default=o,e.exports=r.default},{}],37:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={texture:"USE_TEXTURE",directionLights:"DIR_LIGHT_NUM"},e.exports=r.default},{}],38:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=t("./SpriteRenderer"),u=n(a),s=t("./TransparentRenderer"),c=n(s),l=function(){function t(e){i(this,t),this._container="string"==typeof e.container?document.getElementById(e.container):e.container,this._pixelRatio=e.pixelRatio||1,this._antialias=void 0!==e.antialias?e.antialias:!0,this.autoClear=void 0!==e.autoClear?e.autoClear:!0,this.clearColor=e.clearColor||[1,1,1,1],this.sortObjects=!0,this._spriteRenderer=new u.default,this._transparentRenderer=new c.default,this._initializeCanvas()}return o(t,[{key:"setPixelRatio",value:function(t){return this._pixelRatio=t,this}},{key:"getPixelRatio",value:function(){return this._pixelRatio}},{key:"setSize",value:function(t,e){return this._size=[t*this._pixelRatio,e*this._pixelRatio],this._canvasElement.width=this._size[0],this._canvasElement.height=this._size[1],this._canvasElement.style.width=t+"px",this._canvasElement.style.height=e+"px",this._gl.viewport(0,0,this._size[0],this._size[1]),this}},{key:"getSize",value:function(){return this._size}},{key:"clear",value:function(){var t=this._gl;return t.clearColor.apply(t,this.clearColor),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this}},{key:"render",value:function(t,e){var r=this._gl,n={common:[],transparent:[],sprites:[]};t.typifyForRender(n),r.clearDepth(1),r.clearStencil(0),r.enable(r.DEPTH_TEST),r.depthFunc(r.LEQUAL),r.frontFace(r.CCW),r.cullFace(r.BACK),r.enable(r.CULL_FACE),this.autoClear&&this.clear(),e.updateLocalMatrix(),e.updateWorldMatrix(),r.disable(r.BLEND);var i={renderer:this,scene:t,camera:e,gl:r};return n.common.forEach(function(t){return t.render(i)}),this._transparentRenderer.render(i,n.transparent),this._spriteRenderer.render(i,n.sprites),this}},{key:"_initializeCanvas",value:function(){this._canvasElement=document.createElement("canvas"),this._container.appendChild(this._canvasElement);var t={antialias:this._antialias};this._gl=this._canvasElement.getContext("webgl",t)}}]),t}();r.default=l,e.exports=r.default},{"./SpriteRenderer":39,"./TransparentRenderer":40}],39:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=t("../shaders"),u=t("../Geometry"),s=n(u),c=t("../Buffer"),l=n(c),f=function(){function t(){i(this,t),this._shader=a.sprite,this._geometry=new s.default,this._geometry.setBuffer("position",new l.default(new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),3)).setBuffer("texture",new l.default(new Float32Array([0,0,1,0,1,1,0,1]),2)).setBuffer("index",new l.default(new Uint16Array([1,2,0,3,0,2]),1)),this._geometry.getBuffer("index").type=l.default.ElementArrayBuffer}return o(t,[{key:"render",value:function(t,e){var r=t.gl,n=t.camera;r.disable(r.DEPTH_TEST),r.enable(r.BLEND),r.blendEquation(r.FUNC_ADD),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA),r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD),r.blendFuncSeparate(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA),this._shaderProgram||this._prepare(t),r.useProgram(this._shaderProgram),r.enableVertexAttribArray(this._attributes.position),r.enableVertexAttribArray(this._attributes.texture),this._geometry.getBuffer("position").bind(r,this._attributes.position),this._geometry.getBuffer("texture").bind(r,this._attributes.texture),r.uniformMatrix4fv(this._uniforms.uPCamera,!1,new Float32Array(n.modelViewMatrix)),this._geometry.getBuffer("index").bind(r),r.activeTexture(r.TEXTURE0),r.uniform1i(this._uniforms.uTexture,0),t.uniforms=this._uniforms,e.forEach(function(e){return e.render(t)}),r.disableVertexAttribArray(this._attributes.position),r.disableVertexAttribArray(this._attributes.texture)}},{key:"_prepare",value:function(t){this._prepareShaders(t),this._prepareAttributes(t),this._prepareUniforms(t)}},{key:"_prepareShaders",value:function(t){var e=t.gl,r=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(r,this._shader.fragment),e.compileShader(r);var n=e.createShader(e.VERTEX_SHADER);e.shaderSource(n,this._shader.vertex),e.compileShader(n),this._shaderProgram=e.createProgram(),e.attachShader(this._shaderProgram,n),e.attachShader(this._shaderProgram,r),e.linkProgram(this._shaderProgram)}},{key:"_prepareAttributes",value:function(t){var e=t.gl;this._attributes={position:e.getAttribLocation(this._shaderProgram,"position"),texture:e.getAttribLocation(this._shaderProgram,"texture")}}},{key:"_prepareUniforms",value:function(t){var e=t.gl;this._uniforms={uPCamera:e.getUniformLocation(this._shaderProgram,"uPCamera"),uPosition:e.getUniformLocation(this._shaderProgram,"uPosition"),uColorAlpha:e.getUniformLocation(this._shaderProgram,"uColorAlpha"),uTexture:e.getUniformLocation(this._shaderProgram,"uTexture"),uScale:e.getUniformLocation(this._shaderProgram,"uScale"),uHalfSize:e.getUniformLocation(this._shaderProgram,"uHalfSize"),uOffset:e.getUniformLocation(this._shaderProgram,"uOffset"),uSmoothing:e.getUniformLocation(this._shaderProgram,"uSmoothing")}}}]),t}();r.default=f,e.exports=r.default},{"../Buffer":13,"../Geometry":14,"../shaders":41}],40:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=function(){function t(){n(this,t)}return i(t,[{key:"render",value:function(t,e){var r=t.gl;r.enable(r.BLEND),r.blendEquation(r.FUNC_ADD),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA),r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD),r.blendFuncSeparate(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA),t.renderer.sortObjects&&(e=this._sortObjects(t,e)),e.forEach(function(e){return e.render(t)})}},{key:"_sortObjects",value:function(t,e){var r=t.camera,n=e.map(function(t){return{object:t,z:r.project(t.getWorldPosition())[2]}});return n.sort(this._reversePainterSortStable),n.map(function(t){return t.object})}},{key:"_reversePainterSortStable",value:function(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.z!==e.z?e.z-t.z:void 0}}]),t}();r.default=o,e.exports=r.default},{}],41:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});t("path");r.default={basic:{vertex:"attribute vec3 position;\n\nuniform mat4 uPosition;\nuniform mat4 uCamera;\nuniform vec3 uColor;\nuniform vec3 uEmissive;\n\nvarying vec3 vColor;\n\nvoid main(void) {\n    vColor = uColor;\n\n    gl_Position = uCamera * uPosition * vec4(position, 1.0);\n}\n",fragment:"precision mediump float;\n\nuniform float uColorAlpha;\nvarying vec3 vColor;\n\nvoid main(void) {\n    gl_FragColor = vec4(vColor.rgb, uColorAlpha);\n}\n"},complex:{vertex:"attribute vec3 position;\nattribute vec3 color;\nattribute vec3 emissive;\n\n#ifdef USE_TEXTURE\n    attribute vec2 texture;\n    attribute float textureEnable;\n    varying vec2 vTextureCoord;\n    varying float vTextureEnable;\n#endif\n\n#if DIR_LIGHT_NUM > 0\n    attribute vec3 normal;\n    uniform vec3 uDirectionLightColors[DIR_LIGHT_NUM];\n    uniform vec3 uDirectionLightPositions[DIR_LIGHT_NUM];\n    uniform mat3 uNormalMatrix;\n#endif\n\nuniform mat4 uPosition;\nuniform vec3 uAmbientLightColor;\nuniform mat4 uCamera;\n\nvarying vec3 vColor;\nvarying vec3 vEmissive;\nvarying vec3 vLightWeighting;\n\nvoid main(void) {\n    vColor = color;\n    vEmissive = emissive;\n\n    #ifdef USE_TEXTURE\n        vTextureCoord = texture;\n        vTextureEnable = textureEnable;\n    #endif\n\n    vec3 vLightTemp = vec3(0.0);\n\n    #if DIR_LIGHT_NUM > 0\n        vec3 transformedNormal = uNormalMatrix * normal;\n\n        for(int i = 0; i < DIR_LIGHT_NUM; i++) {\n            float dotProduct = dot(transformedNormal, uDirectionLightPositions[i]);\n            vec3 directionalLightWeighting = vec3(max(dotProduct, 0.0));\n            vLightTemp += uDirectionLightColors[i] * directionalLightWeighting;\n        }\n    #endif\n\n    vLightWeighting = uAmbientLightColor + vLightTemp;\n\n    gl_Position = uCamera * uPosition * vec4(position, 1.0);\n}\n",fragment:"precision mediump float;\n\n#ifdef USE_TEXTURE\n    uniform sampler2D uTexture;\n    varying vec2 vTextureCoord;\n    varying float vTextureEnable;\n#endif\n\nuniform float uColorAlpha;\nvarying vec3 vLightWeighting;\nvarying vec3 vColor;\nvarying vec3 vEmissive;\n\nvoid main(void) {\n    vec4 color = vec4(vColor.rgb, uColorAlpha);\n\n    #ifdef USE_TEXTURE\n        if (vTextureEnable > 0.5) {\n            vec4 textureColor = texture2D(uTexture, vec2(vTextureCoord.s, vTextureCoord.t));\n            color = vec4(textureColor.rgb * color.rgb, color.a);\n        }\n    #endif\n\n    gl_FragColor = vec4(color.rgb * vLightWeighting + vEmissive, color.a);\n}\n"},sprite:{vertex:"attribute vec2 position;\nattribute vec2 texture;\n\nuniform vec3 uPosition;\nuniform mat4 uPCamera;\nuniform vec2 uScale;\nuniform vec2 uHalfSize;\nuniform vec2 uOffset;\nuniform int uSmoothing;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n    vTextureCoord = texture;\n\n    vec2 alignedPosition = position * uScale;\n    alignedPosition += uOffset;\n    alignedPosition /= uHalfSize;\n\n    vec4 ndcPosition = uPCamera * vec4(uPosition, 1.0);\n    ndcPosition.xyz = ndcPosition.xyz / ndcPosition.w;\n    ndcPosition.w = 1.0;\n    ndcPosition.xy += alignedPosition.xy;\n\n    if (uSmoothing == 1) {\n        ndcPosition.xy = floor((ndcPosition.xy + 1.0) * uHalfSize.xy + 0.5) / uHalfSize.xy - 1.0;\n    }\n\n    gl_Position = ndcPosition;\n}\n",fragment:"precision mediump float;\n\nuniform float uColorAlpha;\nuniform sampler2D uTexture;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n    vec4 textureColor = texture2D(uTexture, vec2(vTextureCoord.s, vTextureCoord.t));\n\n    gl_FragColor = vec4(textureColor.rgb, textureColor.a * uColorAlpha);\n}\n"}},e.exports=r.default},{path:1}]},{},[24])(24)});
